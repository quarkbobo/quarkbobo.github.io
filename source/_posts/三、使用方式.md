## 三、使用方式

1. **启动大厅服（VPS/公网机器）**

   ```
   python lobby_server.py --host 0.0.0.0 --port 8080
   ```

   - 服务器控制台会显示 `http://<服务器IP>:8080`。
   - 大厅保留房间 25 秒（TTL）；主机每 5 秒上报一次心跳。

2. **主机开房**

   - 主机电脑运行：`python snake_arena_lobby.py`
   - 填入 **昵称**、**Lobby 地址**（如 `http://你的VPS:8080`）、**端口**（默认 7777/UDP）、**关卡/皮肤** → 点 **“开房(互联网)”**。
   - **路由器端口映射**：将 UDP `7777` 转发到主机内网 IP（公网直连或 VPS 环境可忽略）。

3. **玩家加入**

   - 玩家电脑运行：`python snake_arena_lobby.py`
   - 填同一个 **Lobby 地址** → 点 **“刷新房间”** → 选择房间 → **“加入(互联网)”**。

4. **游戏内快捷键**

   - P：暂停/继续；R：重开；N：下一关（主机/本地）
   - F1：切换皮肤；F2：切换关卡（主机/本地）
   - Esc：退出到主菜单
   - P1：方向键；P2：WASD；手柄：第一个手柄控 P1，第二个手柄（本地模式）控 P2；触控/滑动默认控 P1

------

## 四、打包脚本（可选）

**Windows：`build_win.bat`**

```
@echo off
pip install pyinstaller
pyinstaller -F -w -n SnakeArena snake_arena_lobby.py
pyinstaller -F -w -n SnakeLobby lobby_server.py
REM 产物：dist\SnakeArena.exe 与 dist\SnakeLobby.exe
```

**macOS：`build_mac.sh`**

```
#!/usr/bin/env bash
pip install pyinstaller
pyinstaller -F -w -n SnakeArena --osx-bundle-identifier com.example.snakearena snake_arena_lobby.py
pyinstaller -F -w -n SnakeLobby  --osx-bundle-identifier com.example.snakelobby  lobby_server.py
# 产物：dist/SnakeArena(.app) 与 dist/SnakeLobby(.app)
```

------

## 五、说明与可扩展点

- **NAT/公网连通**：本方案使用 UDP，跨公网需要主机做端口映射；或将游戏部署在公网机器（云主机）。需要 STUN/打洞/中继可继续扩展（我可以给你集成简单的 TURN/中继服务）。
- **公平性**：当前实现为“全局 tick”速度（加速/减速影响全局，以简化对战）。如需“只影响自己”，可改为**玩家跳步/停步**逻辑。
- **稳定性**：客户端完全服从主机快照；状态包默认 ~20Hz。网络差时可把 `NET_STATE_HZ` 降到 10Hz（省带宽）。
- **UI 扩展**：可加入更完整的菜单（图标、滚动房间列表、搜索、密码房、观战位）。
- **皮肤/关卡资源**：目前为内置配色。若要 PNG/像素字体/音效包，我可以给你：资源目录结构、加载与打包（.spec 的 `datas` 配置）。