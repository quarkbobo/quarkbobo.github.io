<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>æ–‡ä»¶ä¸‹è½½ä¸­å¿ƒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- å¼•å…¥ SheetJSï¼Œç”¨æ¥åœ¨æµè§ˆå™¨é‡Œç”Ÿæˆ .xlsx æ–‡ä»¶ï¼ˆé™æ€ CDNï¼Œæ— éœ€åç«¯ï¼‰ -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Microsoft YaHei",sans-serif;
      background: #f3f4f6;
      color: #111827;
      line-height: 1.6;
    }
    main {
      max-width: 960px;
      margin: 32px auto;
      padding: 0 16px;
    }
    h1 {
      font-size: 26px;
      margin-bottom: 8px;
    }
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 20px 18px;
      box-shadow: 0 8px 20px rgba(15,23,42,.06);
      margin-bottom: 20px;
    }
    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 12px;
    }
    button {
      border: none;
      border-radius: 999px;
      padding: 8px 14px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: #4f46e5;
      color: #fff;
      box-shadow: 0 4px 12px rgba(79,70,229,.4);
      transition: transform .08s ease, box-shadow .12s ease, background .1s;
    }
    button.secondary {
      background: #f9fafb;
      color: #374151;
      box-shadow: none;
      border: 1px solid #e5e7eb;
    }
    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 16px rgba(79,70,229,.5);
    }
    button.secondary:hover {
      background: #e5e7eb;
      box-shadow: none;
    }
    code {
      background: #e5e7eb;
      border-radius: 4px;
      padding: 2px 4px;
      font-size: 13px;
    }
    ul {
      margin-left: 18px;
      font-size: 14px;
      color: #4b5563;
    }
    footer {
      text-align: center;
      font-size: 12px;
      color: #9ca3af;
      margin-top: 24px;
      padding-bottom: 16px;
    }
  </style>
</head>
<body>
<main>
  <div class="card">
    <h1>æ–‡ä»¶ä¸‹è½½ä¸­å¿ƒ</h1>
    <p style="font-size:14px;color:#4b5563;margin-top:4px;">
      æœ¬ç«™ä¸ºé™æ€ç½‘ç«™ï¼Œä¸‹é¢ä¸¤ä¸ªæŒ‰é’®ä¼šåœ¨ä½ çš„æµè§ˆå™¨ä¸­åŠ¨æ€ç”Ÿæˆ <code>.xlsx</code> æ–‡ä»¶å¹¶è‡ªåŠ¨ä¸‹è½½ã€‚
    </p>
  </div>

  <div class="card">
    <h2 style="font-size:18px;margin-bottom:6px;">ğŸ“„ ç”Ÿæˆç›®å½• Excel</h2>
    <p style="font-size:14px;color:#4b5563;">
      ä½ å¯ä»¥ä¸‹è½½ï¼š
    </p>
    <ul>
      <li><strong>index_and_downloads.xlsx</strong>ï¼šåŒ…å« <code>index.html</code> å’Œ <code>downloads/</code> è¿™ä¸€å±‚çš„æ–‡ä»¶/æ–‡ä»¶å¤¹ã€‚</li>
      <li><strong>downloads_recursive.xlsx</strong>ï¼šåŒ…å« <code>downloads/</code> ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼ˆé€’å½’å­æ–‡ä»¶å¤¹ï¼‰ã€‚</li>
    </ul>

    <div class="btn-row">
      <button onclick="downloadRootXlsx()">
        ğŸ“ ä¸‹è½½ index.html + downloads åˆ—è¡¨
      </button>
      <button class="secondary" onclick="downloadDownloadsRecursiveXlsx()">
        ğŸ§¬ ä¸‹è½½ downloads é€’å½’åˆ—è¡¨
      </button>
    </div>

    <p style="font-size:12px;color:#9ca3af;margin-top:10px;">
      æ³¨æ„ï¼šç”±äºæ˜¯é™æ€ç½‘ç«™ï¼Œä¸‹é¢çš„ç›®å½•ä¿¡æ¯éœ€è¦ä½ åœ¨ <code>index.html</code> é‡Œæ‰‹åŠ¨ç»´æŠ¤ï¼ˆè§é¡µé¢åº•éƒ¨ JS é…ç½®ï¼‰ã€‚
    </p>
  </div>

  <div class="card">
    <h2 style="font-size:16px;margin-bottom:6px;">ğŸ”§ å¦‚ä½•é…ç½®è‡ªå·±çš„æ–‡ä»¶åˆ—è¡¨ï¼Ÿ</h2>
    <p style="font-size:14px;color:#4b5563;">
      æ‰“å¼€æœ¬æ–‡ä»¶åº•éƒ¨çš„ <code>&lt;script&gt;</code>ï¼Œæ‰¾åˆ° <code>rootEntries</code> å’Œ <code>downloadsRecursiveEntries</code>ï¼ŒæŒ‰ä½ çš„å®é™…æ–‡ä»¶è·¯å¾„ä¿®æ”¹å³å¯ã€‚
    </p>
    <ul style="margin-top:6px;">
      <li>è·¯å¾„å»ºè®®å†™æˆç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„è·¯å¾„ï¼Œä¾‹å¦‚ï¼š<code>index.html</code>ã€<code>downloads/tool.exe</code>ã€‚</li>
      <li>å¦‚æœæ‡’å¾—å¡«å¤§å°ã€æ—¶é—´ï¼Œå¯ä»¥ç•™ç©ºæˆ–å†™ 0ï¼ŒExcel ä¾ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</li>
    </ul>
  </div>

  <footer>
    é™æ€æœåŠ¡å™¨ç¤ºä¾‹ Â· ä»…ç”¨ index.html ä¸ downloads ç›®å½•å®ç°ç›®å½• Excel ä¸‹è½½
  </footer>
</main>

<script>
  /************ 1. åœ¨è¿™é‡Œé…ç½®ä½ çš„ç›®å½•ä¿¡æ¯ ************/

  // 1) æ ¹ç›®å½• + downloads è¿™ä¸€å±‚ï¼ˆç”Ÿæˆ index_and_downloads.xlsxï¼‰
  //   - ä½ å¯ä»¥æŒ‰éœ€ä¿®æ”¹ / å¢åŠ  / åˆ é™¤
  const rootEntries = [
    { path: "index.html",      type: "æ–‡ä»¶",   size: "", mtime: "" },
    { path: "downloads/",      type: "æ–‡ä»¶å¤¹", size: "", mtime: "" },

    // å¦‚æœæ ¹ç›®å½•è¿˜æœ‰å…¶ä»–æ–‡ä»¶/æ–‡ä»¶å¤¹ï¼Œå¯ä»¥ç»§ç»­åŠ ï¼Œä¾‹å¦‚ï¼š
    // { path: "about.html", type: "æ–‡ä»¶", size: "", mtime: "" },
    // { path: "assets/",    type: "æ–‡ä»¶å¤¹", size: "", mtime: "" },
  ];

  // 2) downloads ç›®å½•é€’å½’çš„æ‰€æœ‰å†…å®¹ï¼ˆç”Ÿæˆ downloads_recursive.xlsxï¼‰
  //    è¿™é‡Œéœ€è¦ä½ æŠŠ downloads ä¸‹çš„æ–‡ä»¶ & å­ç›®å½•å†™å‡ºæ¥ã€‚
  //    ä¸‹é¢æ˜¯ç¤ºä¾‹ï¼Œä½ æŒ‰ä½ çš„å®é™…æƒ…å†µæ”¹ï¼š
  const downloadsRecursiveEntries = [
    // ç›´æ¥åœ¨ downloads ç›®å½•ä¸‹çš„æ–‡ä»¶
    { path: "downloads/aaa.txt",           type: "æ–‡ä»¶",   size: "", mtime: "" },
    { path: "downloads/tool.exe",          type: "æ–‡ä»¶",   size: "", mtime: "" },

    // downloads ä¸‹çš„å­æ–‡ä»¶å¤¹å’Œé‡Œé¢çš„æ–‡ä»¶
    { path: "downloads/sub/",              type: "æ–‡ä»¶å¤¹", size: "", mtime: "" },
    { path: "downloads/sub/bbb.docx",      type: "æ–‡ä»¶",   size: "", mtime: "" },

    // æŒ‰ä½ çš„å®é™…ç›®å½•ç»§ç»­åŠ â€¦â€¦
    // { path: "downloads/images/",        type: "æ–‡ä»¶å¤¹", size: "", mtime: "" },
    // { path: "downloads/images/logo.png",type: "æ–‡ä»¶",   size: "", mtime: "" },
  ];

  /************ 2. é€šç”¨å‡½æ•°ï¼šç”Ÿæˆå¹¶ä¸‹è½½ Excel (.xlsx) ************/
  function makeAndDownloadXlsx(sheetName, dataArray, fileName) {
    // dataArray æ˜¯å½¢å¦‚ {path, type, size, mtime} çš„å¯¹è±¡æ•°ç»„
    const wb = XLSX.utils.book_new();
    const ws = XLSX.utils.json_to_sheet(dataArray, {
      header: ["path", "type", "size", "mtime"]
    });

    // è®¾ç½®è¡¨å¤´ä¸­æ–‡
    // æŠŠ A1~D1 æ”¹æˆä¸­æ–‡æ ‡é¢˜
    XLSX.utils.sheet_add_aoa(ws, [["è·¯å¾„", "ç±»å‹", "å¤§å°", "æœ€åä¿®æ”¹æ—¶é—´"]], { origin: "A1" });

    // æŠŠå·¥ä½œè¡¨åŠ åˆ°å·¥ä½œç°¿
    XLSX.utils.book_append_sheet(wb, ws, sheetName);

    // å†™æˆ array buffer
    const wbout = XLSX.write(wb, { bookType: "xlsx", type: "array" });

    // ç”Ÿæˆ Blob å¹¶è§¦å‘æµè§ˆå™¨ä¸‹è½½
    const blob = new Blob([wbout], {
      type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
    });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = fileName;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }

  /************ 3. æŒ‰é’®è§¦å‘å‡½æ•° ************/
  function downloadRootXlsx() {
    makeAndDownloadXlsx("root_and_downloads", rootEntries, "index_and_downloads.xlsx");
  }

  function downloadDownloadsRecursiveXlsx() {
    makeAndDownloadXlsx("downloads_recursive", downloadsRecursiveEntries, "downloads_recursive.xlsx");
  }
</script>
</body>
</html>
